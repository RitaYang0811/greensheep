import{M as I}from"./modal-BgRkDVJV.js";import{W as F,_ as L,o as a,c as l,e,b as _,w as f,F as y,d as m,f as b,x as h,g as U,V as G,r as N,t as u,j as x,u as T,i as p}from"./index-C0y58dQD.js";import{d as k}from"./dateToUnix-DUte0kxx.js";import{t as w,a as P}from"./sweetalertToast-CE5DIVFS.js";import"./selector-engine-pmd_kfTy.js";import"./sweetalert2.all-BjkAAmw7.js";function z(o){const t=o.getFullYear(),d=(o.getMonth()+1).toString().padStart(2,"0"),r=o.getDate().toString().padStart(2,"0");return`${t}-${d}-${r}`}function B(o){const t=new Date(o);return z(t)}F("compareWithDiscount",(o,[t])=>typeof o=="number"&&typeof t=="number"?o>=t?!0:"折抵金額不可大於訂單金額":!0);F("compareWithPrice",(o,[t])=>typeof o=="number"&&typeof t=="number"?o<=t?!0:"折抵金額不可大於訂單金額":!0);const R={props:["coupon","isNew","loadingStatus"],data(){return{modal:"",couponData:"",dateSelected:!0,dateCounter:0}},methods:{datepickerInputStyle(){this.dateCounter++,this.dateCounter>0&&(this.couponData.dates===null||isNaN(this.couponData.dates[0])?this.dateSelected=!1:this.dateSelected=!0)},reset(){this.$refs.couponForm.resetForm()},openModal(){this.modal.show(),this.dateCounter=0,this.dateSelected=!0},closeModal(){this.modal.hide()},unixToDate(o){const t=o*1e3;return B(t)},format(o){const t=o.map(d=>z(d));return`${t[0]?t[0]:"請選擇日期"} 至 ${t[1]?t[1]:"請選擇日期"}`},updateCoupon(){if(this.couponData.dates===null||isNaN(this.couponData.dates[0])){this.dateSelected=!1;return}this.$emit("updateCoupon",this.couponData)}},watch:{coupon(){this.couponData="",this.couponData=this.coupon,this.couponData.dates=[this.couponData.start_date*1e3,this.couponData.due_date*1e3]}},computed:{discountsOption(){const o=[];for(let t=95;t>5;t-=5){let d="";const r=t;t%10?d=`${t} 折`:d=`${t/10} 折`,o.push([d,r])}return o}},mounted(){this.modal=new I(this.$refs.adCouponCompModal,{backdrop:!0})}},j={class:"modal fade ad-coupon",ref:"adCouponCompModal",role:"dialog"},q={class:"modal-dialog modal-dialog-centered"},W={class:"modal-header bg-primary py-2 px-3"},Y={class:"modal-title fs-5 fw-medium text-white"},E=e("i",{class:"bi bi-x-lg text-white"},null,-1),A=[E],H={class:"modal-body py-4 px-6"},K={key:0,class:"d-flex justify-content-center align-items-center",style:{"min-height":"360px"}},O=e("div",{class:"spinner-border",role:"status"},[e("span",{class:"visually-hidden"},"Loading...")],-1),J=[O],Q={key:1,class:"text-start"},X={class:"mb-3"},Z=e("label",{for:"couponCode",class:"form-label fs-6 mb-3"},"優惠碼",-1),$={class:"mb-3"},ee=e("p",{class:"mb-3 fs-6"},"優惠方式",-1),te={class:"form-check mb-3"},se=["checked"],oe=e("label",{class:"form-check-label mb-2",for:"flexRadioDefault1"}," 訂單金額折抵 ",-1),ne={class:"d-flex flex-column gap-2 mb-3"},ae=e("p",{class:"fs-8"},"消費滿 NT$",-1),ie=e("p",{class:"fs-8"},"折抵金額 NT$",-1),le={class:"form-check"},de=e("label",{class:"form-check-label mb-2",for:"flexRadioDefault2"}," 訂單折扣 ",-1),ce={class:"d-flex flex-column gap-2"},re=e("p",{class:"fs-8"},"消費滿 NT$",-1),ue=e("p",{class:"fs-8"},"折扣",-1),pe=e("option",{value:""},"請選擇折扣",-1),he=["value"],_e={class:"mb-3"},me=e("label",{for:"couponCode",class:"form-label fs-6 mb-3"},"開始 / 結束日期",-1),ge={class:"modal-footer py-4 px-6"},be=["disabled"],fe=["disabled"];function ve(o,t,d,r,s,i){const g=x("VField"),C=x("ErrorMessage"),M=x("VueDatePicker"),n=x("VForm");return a(),l("div",j,[e("div",q,[_(n,{class:"modal-content custom-form",ref:"couponForm",onSubmit:i.updateCoupon},{default:f(({errors:v})=>[e("div",W,[e("h2",Y,[d.isNew?(a(),l(y,{key:0},[m("建立優惠券")],64)):(a(),l(y,{key:1},[m("編輯優惠券")],64))]),e("a",{role:"button","aria-label":"Close",onClick:t[0]||(t[0]=b((...c)=>i.closeModal&&i.closeModal(...c),["prevent"]))},A)]),e("div",H,[d.loadingStatus.loadingGetCoupon?(a(),l("div",K,J)):(a(),l("div",Q,[e("div",X,[Z,_(g,{type:"text",name:"優惠碼",rules:"required|alpha_num|max:12",class:h(["form-control",{"is-invalid":v.優惠碼}]),id:"couponCode",placeholder:"設定 12 個字元以內的英文字母和數字",modelValue:s.couponData.code,"onUpdate:modelValue":t[1]||(t[1]=c=>s.couponData.code=c)},null,8,["class","modelValue"]),_(C,{name:"優惠碼",class:"invalid-feedback"})]),e("div",$,[ee,e("div",te,[U(e("input",{class:"form-check-input",type:"radio",id:"flexRadioDefault1",value:"金額折抵","onUpdate:modelValue":t[2]||(t[2]=c=>s.couponData.title=c),checked:d.isNew||s.couponData.title==="金額折抵"},null,8,se),[[G,s.couponData.title]]),oe,e("div",ne,[ae,e("div",null,[_(g,{type:"number",name:"金額",rules:s.couponData.title==="金額折抵"?"required|compareWithDiscount:@折抵金額":"",class:h(["form-control",{"is-invalid":v.金額}]),placeholder:"設定金額",modelValue:s.couponData.min_buy_price_by_price,"onUpdate:modelValue":t[3]||(t[3]=c=>s.couponData.min_buy_price_by_price=c),modelModifiers:{number:!0},disabled:s.couponData.title==="訂單折扣"},null,8,["rules","class","modelValue","disabled"]),_(C,{name:"金額",class:"invalid-feedback"})]),ie,e("div",null,[_(g,{type:"number",name:"折抵金額",rules:s.couponData.title==="金額折抵"?"required|compareWithPrice:@金額":"",class:h(["form-control",{"is-invalid":v.折抵金額}]),placeholder:"設定金額",modelValue:s.couponData.discount_price,"onUpdate:modelValue":t[4]||(t[4]=c=>s.couponData.discount_price=c),modelModifiers:{number:!0},disabled:s.couponData.title==="訂單折扣"},null,8,["rules","class","modelValue","disabled"]),_(C,{name:"折抵金額",class:"invalid-feedback"})])])]),e("div",le,[U(e("input",{class:"form-check-input",type:"radio",id:"flexRadioDefault2",value:"訂單折扣","onUpdate:modelValue":t[5]||(t[5]=c=>s.couponData.title=c)},null,512),[[G,s.couponData.title]]),de,e("div",ce,[re,e("div",null,[_(g,{type:"number",name:"消費金額",rules:{required:s.couponData.title==="訂單折扣"},class:h(["form-control",{"is-invalid":v.消費金額}]),placeholder:"設定金額",modelValue:s.couponData.min_buy_price_by_discount,"onUpdate:modelValue":t[6]||(t[6]=c=>s.couponData.min_buy_price_by_discount=c),modelModifiers:{number:!0},disabled:s.couponData.title==="金額折抵"},null,8,["rules","class","modelValue","disabled"]),_(C,{name:"消費金額",class:"invalid-feedback"})]),ue,e("div",null,[_(g,{as:"select",name:"折扣",rules:{required:s.couponData.title==="訂單折扣"},class:h(["form-control",{"is-invalid":v.折扣}]),placeholder:"請選擇折扣",modelValue:s.couponData.percent,"onUpdate:modelValue":t[7]||(t[7]=c=>s.couponData.percent=c),disabled:s.couponData.title==="金額折抵"},{default:f(()=>[pe,(a(!0),l(y,null,N(i.discountsOption,c=>(a(),l("option",{key:c[0],value:c[1]},u(c[0]),9,he))),128))]),_:2},1032,["rules","class","modelValue","disabled"]),_(C,{name:"折扣",class:"invalid-feedback"})])])])]),e("div",_e,[me,_(M,{onBlur:i.datepickerInputStyle,class:h(["dp-custom",{"dp-custom-invalid ":!s.dateSelected}]),"input-class-name":"form-control dp-input",modelValue:s.couponData.dates,"onUpdate:modelValue":t[8]||(t[8]=c=>s.couponData.dates=c),"model-type":"timestamp",range:{partialRange:!1},format:i.format,"enable-time-picker":!1,locale:"zh-TW",cancelText:"取消",selectText:"選擇",required:""},null,8,["onBlur","class","modelValue","format"]),e("span",{role:"alert",class:h(["invalid-feedback",{"d-block":!s.dateSelected}])},"請選擇開始 / 結束日期",2)])]))]),e("div",ge,[e("button",{type:"button",class:"btn btn-outline-primary border-1",disabled:d.loadingStatus.loadingGetCoupon,onClick:t[9]||(t[9]=(...c)=>i.closeModal&&i.closeModal(...c))}," 取消 ",8,be),e("button",{type:"submit",class:"btn btn-primary",disabled:d.loadingStatus.loadingGetCoupon},"確定",8,fe)])]),_:1},8,["onSubmit"])])],512)}const ye=L(R,[["render",ve]]),D="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='18px'%20viewBox='0%200%2024%2024'%20width='18px'%20fill='%23198754'%3e%3cpath%20d='M0%200h24v24H0z'%20fill='none'/%3e%3cpath%20d='M12%202C6.48%202%202%206.48%202%2012s4.48%2010%2010%2010%2010-4.48%2010-10S17.52%202%2012%202zm-2%2015-5-5%201.41-1.41L10%2014.17l7.59-7.59L19%208l-9%209z'/%3e%3c/svg%3e",V="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='18px'%20viewBox='0%200%2024%2024'%20width='18px'%20fill='%23dc3545'%3e%3cpath%20d='M0%200h24v24H0z'%20fill='none'/%3e%3cpath%20d='M12%202C6.47%202%202%206.47%202%2012s4.47%2010%2010%2010%2010-4.47%2010-10S17.53%202%2012%202zm5%2013.59L15.59%2017%2012%2013.41%208.41%2017%207%2015.59%2010.59%2012%207%208.41%208.41%207%2012%2010.59%2015.59%207%2017%208.41%2013.41%2012%2017%2015.59z'/%3e%3c/svg%3e",S="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='18px'%20viewBox='0%200%2024%2024'%20width='18px'%20fill='%239f9f9f'%3e%3cpath%20d='M0%200h24v24H0z'%20fill='none'/%3e%3cpath%20d='M12%202C6.48%202%202%206.48%202%2012s4.48%2010%2010%2010%2010-4.48%2010-10S17.52%202%2012%202zm5%2011H7v-2h10v2z'/%3e%3c/svg%3e",Ce={data(){return{currentTab:"所有優惠券",currentPageCoupons:[],currentPage:1,coupons:[],validCoupons:[],notYetValidCoupons:[],InvalidCoupons:[],coupon:{},isNew:!0,isLoading:!1,loadingStatus:{loadingGetCoupons:!1,loadingGetCoupon:!1,loadingDelCoupon:""}}},components:{AdCouponModal:ye},methods:{async getCoupons(){this.coupons=[],this.validCoupons=[],this.InvalidCoupons=[],this.notYetValidCoupons=[],this.currentPageCoupons=[],this.loadingStatus.loadingGetCoupons=!0;let o,t;const d="https://ec-course-api.hexschool.io/v2/api/greensheep/admin/coupons";try{const r=await this.$http.get(d);for(this.coupons=r.data.coupons,o=r.data.pagination.current_page+1,t=r.data.pagination.total_pages;o<=t;){const s=await this.$http.get(`${d}?page=${o}`);this.coupons=[...this.coupons,...s.data.coupons],o++}}catch(r){w(r.response.data.message)}this.filterCoupons(),this.changePage(this.currentPage),this.loadingStatus.loadingGetCoupons=!1},filterCoupons(){this.coupons.forEach(o=>{k("now")>o.start_date&&k("now")<o.due_date?this.validCoupons.push(o):k("now")>o.due_date?this.InvalidCoupons.push(o):k("now")<o.start_date&&this.notYetValidCoupons.push(o)})},changePage(o){switch(this.currentTab){case"所有優惠券":this.currentPageCoupons=this.coupons.slice((o-1)*10,o*10);break;case"有效":this.currentPageCoupons=this.validCoupons.slice((o-1)*10,o*10);break;case"尚未生效":this.currentPageCoupons=this.notYetValidCoupons.slice((o-1)*10,o*10);break;case"已失效":this.currentPageCoupons=this.InvalidCoupons.slice((o-1)*10,o*10);break}},changeTab(o){this.currentTab=o,this.currentPage=1,this.changePage(this.currentPage)},async getCoupon(o){try{this.loadingStatus.loadingGetCoupon=!0;const d=await this.$http.get("https://ec-course-api.hexschool.io/v2/api/greensheep/admin/coupons");this.coupon=d.data.coupons.find(r=>r.id===o),this.loadingStatus.loadingGetCoupon=!1}catch(t){w(t.response.data.message)}finally{this.loadingStatus.loadingGetCoupon=!1}},updateCoupon(o){this.loadingStatus.loadingGetCoupon=!0;const t={title:o.title,is_enabled:1,percent:o.title==="金額折抵"?100:o.percent,start_date:o.dates[0]/1e3,due_date:o.dates[1]/1e3,code:o.code};if(o.title==="金額折抵"?(t.min_buy_price_by_price=o.min_buy_price_by_price,t.discount_price=o.discount_price):o.title==="訂單折扣"&&(t.min_buy_price_by_discount=o.min_buy_price_by_discount),this.isNew)this.$http.post("https://ec-course-api.hexschool.io/v2/api/greensheep/admin/coupon",{data:t}).then(r=>{P(r.data.message),this.$refs.adCouponModal.closeModal(),this.getCoupons()}).catch(r=>{w(r.response.data.message)}).finally(()=>{this.loadingStatus.loadingGetCoupon=!1});else if(!this.isNew){const r=`https://ec-course-api.hexschool.io/v2/api/greensheep/admin/coupon/${o.id}`;this.$http.put(r,{data:t}).then(s=>{P(s.data.message),this.$refs.adCouponModal.closeModal(),this.getCoupons()}).catch(s=>{w(s.response.data.message)}).finally(()=>{this.loadingStatus.loadingGetCoupon=!1})}},deleteCoupon(o){this.loadingStatus.loadingDelCoupon=o;const t=`https://ec-course-api.hexschool.io/v2/api/greensheep/admin/coupon/${o}`;this.$http.delete(t).then(d=>{P(d.data.message),this.getCoupons()}).catch(d=>{w(d.response.data.message)}).finally(()=>{this.loadingStatus.loadingDelCoupon=""})},async openModal(o,t){switch(o){case"new":this.$refs.adCouponModal.reset(),this.isNew=!0,this.coupon={title:"金額折抵"},console.log("this.coupon",this.coupon),this.$refs.adCouponModal.openModal();break;case"edit":this.$refs.adCouponModal.reset(),this.isNew=!1,this.$refs.adCouponModal.openModal(),await this.getCoupon(t);break}},unixToDate(o){const t=o*1e3;return B(t)},dateToUnix(o="now"){return k(o)}},mounted(){this.getCoupons()}},xe={class:"ad-coupon px-lg-10 pt-3 pt-lg-10 text-start"},ke=e("h1",{class:"fs-3 mb-4 fw-bold"},"優惠管理",-1),we={class:"nav flex-nowrap text-nowrap overflow-x-scroll overflow-x-sm-auto border-bottom border-primary mb-4"},Te={class:"nav-item"},De={class:"nav-item"},Ve={class:"nav-item"},Se={class:"nav-item"},Me={class:"table-container table-responsive d-none d-lg-block"},Pe={class:"table align-middle text-nowrap mb-4"},Ne=e("thead",{class:"table-head position-relative"},[e("tr",null,[e("th",{style:{width:"15%"}},"優惠碼"),e("th",{style:{width:"30%"}},"優惠型式"),e("th",{style:{width:"15%"}},"開始日期"),e("th",{style:{width:"15%"}},"結束日期"),e("th",{style:{width:"15%"}},"狀態"),e("th",{style:{width:"5%"}}),e("th",{style:{width:"5%"}})])],-1),Ue={class:"py-5"},Ge={class:"fw-bold mb-4"},Fe={key:0},Le={key:1},ze={key:0,class:"text-success"},Be=e("img",{src:D,alt:"有效",class:"align-top"},null,-1),Ie={key:1,class:"text-danger"},Re=e("img",{src:V,alt:"已失效",class:"align-top"},null,-1),je={key:2},qe=e("img",{src:S,alt:"已失效",class:"align-top"},null,-1),We={key:1,class:"text-success"},Ye=e("img",{src:D,alt:"有效",class:"align-top"},null,-1),Ee={key:2},Ae=e("img",{src:S,alt:"已失效",class:"align-top"},null,-1),He={key:3,class:"text-danger"},Ke=e("img",{src:V,alt:"已失效",class:"align-top"},null,-1),Oe=["onClick"],Je=e("i",{class:"bi bi-pencil-fill text-dark fs-6"},null,-1),Qe=[Je],Xe={class:"d-flex align-items-center"},Ze=["onClick"],$e=e("i",{class:"bi bi-trash3-fill text-dark fs-6"},null,-1),et=[$e],tt={key:0,class:"spinner-border spinner-border-sm",role:"status"},st=e("span",{class:"visually-hidden"},"Loading...",-1),ot=[st],nt={class:"row list-unstyled text-dark d-lg-none",style:{"row-gap":"12px"}},at={class:"border border-primary rounded overflow-hidden"},it={class:"row g-0"},lt={class:"col-12"},dt={class:"bg-primary d-flex justify-content-between align-items-center px-2 py-2"},ct={class:"bg-primary text-white fw-bold"},rt={class:"text-end bg-white rounded-pill px-2 py-1 fs-8"},ut={key:0,class:"text-success"},pt=e("img",{src:D,alt:"有效",class:"align-top"},null,-1),ht={key:1,class:"text-danger"},_t=e("img",{src:V,alt:"已失效",class:"align-top"},null,-1),mt={key:2},gt=e("img",{src:S,alt:"已失效",class:"align-top"},null,-1),bt={key:1,class:"text-success"},ft=e("img",{src:D,alt:"有效",class:"align-top"},null,-1),vt={key:2},yt=e("img",{src:S,alt:"已失效",class:"align-top"},null,-1),Ct={key:3,class:"text-danger"},xt=e("img",{src:V,alt:"已失效",class:"align-top"},null,-1),kt={class:"col-12"},wt={class:"px-2 py-2 border-bottom border-primary"},Tt={class:"fw-bold mb-2"},Dt={key:0},Vt={key:1},St={class:"col-9"},Mt={class:"px-2 py-2"},Pt={class:"col-3"},Nt={class:"d-flex justify-content-between justify-content-sm-evenly pe-4 py-2"},Ut=["onClick"],Gt=e("i",{class:"bi bi-pencil-fill text-dark fs-6"},null,-1),Ft=[Gt],Lt=["onClick"],zt=e("i",{class:"bi bi-trash3-fill text-dark fs-6"},null,-1),Bt={key:0,class:"spinner-border spinner-border-sm",role:"status"},It=e("span",{class:"visually-hidden"},"Loading...",-1),Rt=[It],jt={class:"text-center va-pagination"},qt=e("span",{class:"material-icons fs-8 p-1"}," navigate_before ",-1),Wt=e("span",{class:"material-icons fs-8 p-1"}," navigate_next ",-1),Yt=e("span",{class:"material-icons fs-8 p-1"}," navigate_before ",-1),Et=e("span",{class:"material-icons fs-8 p-1"}," navigate_next ",-1),At=e("span",{class:"material-icons fs-8 p-1"}," navigate_before ",-1),Ht=e("span",{class:"material-icons fs-8 p-1"}," navigate_next ",-1),Kt=e("span",{class:"material-icons fs-8 p-1"}," navigate_before ",-1),Ot=e("span",{class:"material-icons fs-8 p-1"}," navigate_next ",-1),Jt={key:0,class:"d-flex justify-content-center align-items-center",style:{"min-height":"360px"}},Qt=e("div",{class:"spinner-border",role:"status"},[e("span",{class:"visually-hidden"},"Loading...")],-1),Xt=[Qt];function Zt(o,t,d,r,s,i){const g=x("vue-awesome-paginate"),C=x("VueLoading"),M=x("AdCouponModal");return a(),l(y,null,[e("div",xe,[ke,e("ul",we,[e("li",Te,[e("a",{class:h(["nav-link px-6 py-4",{active:s.currentTab==="所有優惠券"}]),href:"#",onClick:t[0]||(t[0]=b(n=>i.changeTab("所有優惠券"),["prevent"]))}," 所有優惠券 ",2)]),e("li",De,[e("a",{class:h(["nav-link px-6 py-4",{active:s.currentTab==="有效"}]),href:"#",onClick:t[1]||(t[1]=b(n=>i.changeTab("有效"),["prevent"]))}," 有效 ",2)]),e("li",Ve,[e("a",{class:h(["nav-link px-6 py-4",{active:s.currentTab==="尚未生效"}]),href:"#",onClick:t[2]||(t[2]=b(n=>i.changeTab("尚未生效"),["prevent"]))}," 尚未生效 ",2)]),e("li",Se,[e("a",{class:h(["nav-link px-6 py-4",{active:s.currentTab==="已失效"}]),href:"#",onClick:t[3]||(t[3]=b(n=>i.changeTab("已失效"),["prevent"]))}," 已失效 ",2)])]),e("a",{href:"#",class:"btn btn-primary mb-4",onClick:t[4]||(t[4]=b(n=>i.openModal("new"),["prevent"]))},"新增優惠券"),e("div",Me,[e("table",Pe,[Ne,e("tbody",null,[(a(!0),l(y,null,N(s.currentPageCoupons,n=>(a(),l("tr",{key:n.id},[e("td",null,u(n.code),1),e("td",Ue,[e("p",Ge,u(n.title),1),n.title==="金額折抵"?(a(),l("p",Fe," 消費滿 NT$ "+u(n.min_buy_price_by_price)+"，享 NT$ "+u(n.discount_price)+" 折扣 ",1)):p("",!0),n.title==="訂單折扣"?(a(),l("p",Le," 消費滿 NT$ "+u(n.min_buy_price_by_discount)+"，享 "+u(n.percent%10?n.percent:n.percent/10)+" 折 ",1)):p("",!0)]),e("td",null,u(i.unixToDate(n.start_date)),1),e("td",null,u(i.unixToDate(n.due_date)),1),e("td",null,[s.currentTab==="所有優惠券"?(a(),l(y,{key:0},[i.dateToUnix()>n.start_date&&i.dateToUnix()<n.due_date?(a(),l("span",ze,[m(" 有效 "),Be])):p("",!0),i.dateToUnix()>n.due_date?(a(),l("span",Ie,[m(" 已失效 "),Re])):p("",!0),i.dateToUnix()<n.start_date?(a(),l("span",je,[m(" 尚未生效 "),qe])):p("",!0)],64)):s.currentTab==="有效"?(a(),l("span",We,[m(" 有效 "),Ye])):s.currentTab==="尚未生效"?(a(),l("span",Ee,[m(" 尚未生效 "),Ae])):s.currentTab==="已失效"?(a(),l("span",He,[m(" 已失效 "),Ke])):p("",!0)]),e("td",null,[e("a",{href:"#",class:h({"disabled-link":s.loadingStatus.loadingDelCoupon}),onClick:b(v=>i.openModal("edit",n.id),["prevent"])},Qe,10,Oe)]),e("td",null,[e("div",Xe,[e("a",{href:"#",class:h({"disabled-link":s.loadingStatus.loadingDelCoupon}),onClick:b(v=>i.deleteCoupon(n.id),["prevent"])},et,10,Ze),s.loadingStatus.loadingDelCoupon===n.id?(a(),l("div",tt,ot)):p("",!0)])])]))),128))])])]),e("ul",nt,[(a(!0),l(y,null,N(s.currentPageCoupons,n=>(a(),l("li",{class:"col-12",key:n.id},[e("div",at,[e("div",it,[e("div",lt,[e("div",dt,[e("div",ct,u(n.code),1),e("div",rt,[s.currentTab==="所有優惠券"?(a(),l(y,{key:0},[i.dateToUnix()>n.start_date&&i.dateToUnix()<n.due_date?(a(),l("span",ut,[m(" 有效 "),pt])):p("",!0),i.dateToUnix()>n.due_date?(a(),l("span",ht,[m(" 已失效 "),_t])):p("",!0),i.dateToUnix()<n.start_date?(a(),l("span",mt,[m(" 尚未生效 "),gt])):p("",!0)],64)):s.currentTab==="有效"?(a(),l("span",bt,[m(" 有效 "),ft])):s.currentTab==="尚未生效"?(a(),l("span",vt,[m(" 尚未生效 "),yt])):s.currentTab==="已失效"?(a(),l("span",Ct,[m(" 已失效 "),xt])):p("",!0)])])]),e("div",kt,[e("div",wt,[e("p",Tt,u(n.title),1),n.title==="金額折抵"?(a(),l("p",Dt," 消費滿 NT$ "+u(n.min_buy_price_by_price)+"，享 NT$ "+u(n.discount_price)+" 折扣 ",1)):p("",!0),n.title==="訂單折扣"?(a(),l("p",Vt," 消費滿 NT$ "+u(n.min_buy_price_by_discount)+"，享 "+u(n.percent%10?n.percent:n.percent/10)+" 折 ",1)):p("",!0)])]),e("div",St,[e("p",Mt,u(i.unixToDate(n.start_date))+" 至 "+u(i.unixToDate(n.due_date)),1)]),e("div",Pt,[e("div",Nt,[e("a",{href:"#",class:h({"disabled-link":s.loadingStatus.loadingDelCoupon}),onClick:b(v=>i.openModal("edit",n.id),["prevent"])},Ft,10,Ut),e("a",{href:"#",class:h({"disabled-link":s.loadingStatus.loadingDelCoupon}),onClick:b(v=>i.deleteCoupon(n.id),["prevent"])},[zt,s.loadingStatus.loadingDelCoupon===n.id?(a(),l("div",Bt,Rt)):p("",!0)],10,Lt)])])])])]))),128))]),e("div",jt,[s.currentTab==="所有優惠券"&&!s.loadingStatus.loadingGetCoupons?(a(),T(g,{key:0,"total-items":s.coupons.length,"items-per-page":10,"max-pages-shown":3,modelValue:s.currentPage,"onUpdate:modelValue":t[5]||(t[5]=n=>s.currentPage=n),onClick:i.changePage,"pagination-container-class":"cus-pagination","paginate-buttons-class":"page-link","number-buttons-class":"fs-8","active-page-class":"active"},{"prev-button":f(()=>[qt]),"next-button":f(()=>[Wt]),_:1},8,["total-items","modelValue","onClick"])):s.currentTab==="有效"&&!s.loadingStatus.loadingGetCoupons?(a(),T(g,{key:1,"total-items":s.validCoupons.length,"items-per-page":10,"max-pages-shown":3,modelValue:s.currentPage,"onUpdate:modelValue":t[6]||(t[6]=n=>s.currentPage=n),onClick:i.changePage,"pagination-container-class":"cus-pagination","paginate-buttons-class":"page-link","number-buttons-class":"fs-8","active-page-class":"active"},{"prev-button":f(()=>[Yt]),"next-button":f(()=>[Et]),_:1},8,["total-items","modelValue","onClick"])):s.currentTab==="尚未生效"&&!s.loadingStatus.loadingGetCoupons?(a(),T(g,{key:2,"total-items":s.notYetValidCoupons.length,"items-per-page":10,"max-pages-shown":3,modelValue:s.currentPage,"onUpdate:modelValue":t[7]||(t[7]=n=>s.currentPage=n),onClick:i.changePage,"pagination-container-class":"cus-pagination","paginate-buttons-class":"page-link","number-buttons-class":"fs-8","active-page-class":"active"},{"prev-button":f(()=>[At]),"next-button":f(()=>[Ht]),_:1},8,["total-items","modelValue","onClick"])):s.currentTab==="已失效"&&!s.loadingStatus.loadingGetCoupons?(a(),T(g,{key:3,"total-items":s.InvalidCoupons.length,"items-per-page":10,"max-pages-shown":3,modelValue:s.currentPage,"onUpdate:modelValue":t[8]||(t[8]=n=>s.currentPage=n),onClick:i.changePage,"pagination-container-class":"cus-pagination","paginate-buttons-class":"page-link","number-buttons-class":"fs-8","active-page-class":"active"},{"prev-button":f(()=>[Kt]),"next-button":f(()=>[Ot]),_:1},8,["total-items","modelValue","onClick"])):p("",!0)]),s.loadingStatus.loadingGetCoupons?(a(),l("div",Jt,Xt)):p("",!0)]),_(C,{active:s.isLoading},null,8,["active"]),_(M,{ref:"adCouponModal",coupon:s.coupon,isNew:s.isNew,loadingStatus:s.loadingStatus,onUpdateCoupon:i.updateCoupon},null,8,["coupon","isNew","loadingStatus","onUpdateCoupon"])],64)}const as=L(Ce,[["render",Zt]]);export{as as default};
