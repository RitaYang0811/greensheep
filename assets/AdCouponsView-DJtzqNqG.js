import{M as R}from"./modal-DrU9duTf.js";import{W as G,_ as L,o as a,c as l,e,b as _,w as b,F as x,d as h,f as v,x as m,g as U,V as F,r as N,t as u,j as C,u as V,i as p}from"./index-BbkPRlvS.js";import{d as k}from"./dateToUnix-DUte0kxx.js";import{t as w,a as P}from"./sweetalertToast-D6pcczT1.js";import{s as j}from"./scrollToTop-BdmBcgwt.js";import"./selector-engine-DLa7J_fq.js";import"./sweetalert2.all-CJhZ76az.js";function z(o){const t=o.getFullYear(),d=(o.getMonth()+1).toString().padStart(2,"0"),r=o.getDate().toString().padStart(2,"0");return`${t}-${d}-${r}`}function B(o){const t=new Date(o);return z(t)}G("compareWithDiscount",(o,[t])=>typeof o=="number"&&typeof t=="number"?o>=t?!0:"折抵金額不可大於訂單金額":!0);G("compareWithPrice",(o,[t])=>typeof o=="number"&&typeof t=="number"?o<=t?!0:"折抵金額不可大於訂單金額":!0);const q={props:["coupon","isNew","loadingStatus"],data(){return{modal:"",couponData:""}},methods:{reset(){this.$refs.couponForm.resetForm()},openModal(){this.modal.show()},closeModal(){this.modal.hide()},unixToDate(o){const t=o*1e3;return B(t)},format(o){const t=o.map(d=>z(d));return`${t[0]?t[0]:"請選擇日期"} 至 ${t[1]?t[1]:"請選擇日期"}`},blurValidate(){this.$refs.couponForm.validateField("日期")},updateCoupon(){this.$emit("updateCoupon",this.couponData)}},watch:{coupon(){this.couponData="",this.couponData=this.coupon,this.isNew||(this.couponData.dates=[this.couponData.start_date*1e3,this.couponData.due_date*1e3])}},computed:{discountsOption(){const o=[];for(let t=95;t>5;t-=5){let d="";const r=t;t%10?d=`${t} 折`:d=`${t/10} 折`,o.push([d,r])}return o}},mounted(){this.modal=new R(this.$refs.adCouponCompModal,{backdrop:!0})}},W={class:"modal fade ad-coupon",ref:"adCouponCompModal",role:"dialog"},Y={class:"modal-dialog modal-dialog-centered"},E={class:"modal-header bg-primary py-2 px-3"},I={class:"modal-title fs-5 fw-medium text-white"},A=e("i",{class:"bi bi-x-lg text-white"},null,-1),H=[A],K={class:"modal-body py-4 px-6"},O={key:0,class:"d-flex justify-content-center align-items-center",style:{"min-height":"360px"}},J=e("div",{class:"spinner-border",role:"status"},[e("span",{class:"visually-hidden"},"Loading...")],-1),Q=[J],X={key:1,class:"text-start"},Z={class:"mb-3"},$=e("label",{for:"couponCode",class:"form-label fs-6 mb-3"},"優惠碼",-1),ee={class:"mb-3"},te=e("p",{class:"mb-3 fs-6"},"優惠方式",-1),se={class:"form-check mb-3"},oe=["checked"],ne=e("label",{class:"form-check-label mb-2",for:"flexRadioDefault1"}," 訂單金額折抵 ",-1),ae={class:"d-flex flex-column gap-2 mb-3"},ie=e("p",{class:"fs-8"},"消費滿 NT$",-1),le=e("p",{class:"fs-8"},"折抵金額 NT$",-1),de={class:"form-check"},ce=e("label",{class:"form-check-label mb-2",for:"flexRadioDefault2"}," 訂單折扣 ",-1),re={class:"d-flex flex-column gap-2"},ue=e("p",{class:"fs-8"},"消費滿 NT$",-1),pe=e("p",{class:"fs-8"},"折扣",-1),_e=e("option",{value:""},"請選擇折扣",-1),he=["value"],me={class:"mb-3"},ge=e("label",{for:"couponCode",class:"form-label fs-6 mb-3"},"開始 / 結束日期",-1),be={class:"modal-footer py-4 px-6"},fe=["disabled"],ve=["disabled"];function ye(o,t,d,r,s,i){const g=C("VField"),y=C("ErrorMessage"),S=C("VueDatePicker"),n=C("VForm");return a(),l("div",W,[e("div",Y,[_(n,{class:"modal-content custom-form",ref:"couponForm",onSubmit:i.updateCoupon},{default:b(({errors:f})=>[e("div",E,[e("h2",I,[d.isNew?(a(),l(x,{key:0},[h("建立優惠券")],64)):(a(),l(x,{key:1},[h("編輯優惠券")],64))]),e("a",{role:"button","aria-label":"Close",onClick:t[0]||(t[0]=v((...c)=>i.closeModal&&i.closeModal(...c),["prevent"]))},H)]),e("div",K,[d.loadingStatus.loadingGetCoupon?(a(),l("div",O,Q)):(a(),l("div",X,[e("div",Z,[$,_(g,{type:"text",name:"優惠碼",rules:"required|alpha_num|max:12",class:m(["form-control",{"is-invalid":f.優惠碼}]),id:"couponCode",placeholder:"設定 12 個字元以內的英文字母和數字",modelValue:s.couponData.code,"onUpdate:modelValue":t[1]||(t[1]=c=>s.couponData.code=c)},null,8,["class","modelValue"]),_(y,{name:"優惠碼",class:"invalid-feedback"})]),e("div",ee,[te,e("div",se,[U(e("input",{class:"form-check-input",type:"radio",id:"flexRadioDefault1",value:"金額折抵","onUpdate:modelValue":t[2]||(t[2]=c=>s.couponData.title=c),checked:d.isNew||s.couponData.title==="金額折抵"},null,8,oe),[[F,s.couponData.title]]),ne,e("div",ae,[ie,e("div",null,[_(g,{type:"number",name:"金額",rules:s.couponData.title==="金額折抵"?"required|compareWithDiscount:@折抵金額":"",class:m(["form-control",{"is-invalid":f.金額}]),placeholder:"設定金額",modelValue:s.couponData.min_buy_price_by_price,"onUpdate:modelValue":t[3]||(t[3]=c=>s.couponData.min_buy_price_by_price=c),modelModifiers:{number:!0},disabled:s.couponData.title==="訂單折扣"},null,8,["rules","class","modelValue","disabled"]),_(y,{name:"金額",class:"invalid-feedback"})]),le,e("div",null,[_(g,{type:"number",name:"折抵金額",rules:s.couponData.title==="金額折抵"?"required|compareWithPrice:@金額":"",class:m(["form-control",{"is-invalid":f.折抵金額}]),placeholder:"設定金額",modelValue:s.couponData.discount_price,"onUpdate:modelValue":t[4]||(t[4]=c=>s.couponData.discount_price=c),modelModifiers:{number:!0},disabled:s.couponData.title==="訂單折扣"},null,8,["rules","class","modelValue","disabled"]),_(y,{name:"折抵金額",class:"invalid-feedback"})])])]),e("div",de,[U(e("input",{class:"form-check-input",type:"radio",id:"flexRadioDefault2",value:"訂單折扣","onUpdate:modelValue":t[5]||(t[5]=c=>s.couponData.title=c)},null,512),[[F,s.couponData.title]]),ce,e("div",re,[ue,e("div",null,[_(g,{type:"number",name:"消費金額",rules:{required:s.couponData.title==="訂單折扣"},class:m(["form-control",{"is-invalid":f.消費金額}]),placeholder:"設定金額",modelValue:s.couponData.min_buy_price_by_discount,"onUpdate:modelValue":t[6]||(t[6]=c=>s.couponData.min_buy_price_by_discount=c),modelModifiers:{number:!0},disabled:s.couponData.title==="金額折抵"},null,8,["rules","class","modelValue","disabled"]),_(y,{name:"消費金額",class:"invalid-feedback"})]),pe,e("div",null,[_(g,{as:"select",name:"折扣",rules:{required:s.couponData.title==="訂單折扣"},class:m(["form-control",{"is-invalid":f.折扣}]),placeholder:"請選擇折扣",modelValue:s.couponData.percent,"onUpdate:modelValue":t[7]||(t[7]=c=>s.couponData.percent=c),disabled:s.couponData.title==="金額折抵"},{default:b(()=>[_e,(a(!0),l(x,null,N(i.discountsOption,c=>(a(),l("option",{key:c[0],value:c[1]},u(c[0]),9,he))),128))]),_:2},1032,["rules","class","modelValue","disabled"]),_(y,{name:"折扣",class:"invalid-feedback"})])])])]),e("div",me,[ge,_(g,{name:"日期",modelValue:s.couponData.dates,"onUpdate:modelValue":t[9]||(t[9]=c=>s.couponData.dates=c),rules:"required"},{default:b(()=>[_(S,{modelValue:s.couponData.dates,"onUpdate:modelValue":t[8]||(t[8]=c=>s.couponData.dates=c),"input-class-name":"border-0",class:m(["dp-custom form-control py-0 ps-0 pe-9",{"is-invalid":f.日期}]),"model-type":"timestamp",range:{partialRange:!1},format:i.format,"enable-time-picker":!1,locale:"zh-TW",cancelText:"取消",selectText:"選擇",onBlur:i.blurValidate},null,8,["modelValue","class","format","onBlur"])]),_:2},1032,["modelValue"]),_(y,{name:"日期",class:"invalid-feedback"})])]))]),e("div",be,[e("button",{type:"button",class:"btn btn-outline-primary border-1",disabled:d.loadingStatus.loadingGetCoupon,onClick:t[10]||(t[10]=(...c)=>i.closeModal&&i.closeModal(...c))}," 取消 ",8,fe),e("button",{type:"submit",class:"btn btn-primary",disabled:d.loadingStatus.loadingGetCoupon},"確定",8,ve)])]),_:1},8,["onSubmit"])])],512)}const xe=L(q,[["render",ye]]),T="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='18px'%20viewBox='0%200%2024%2024'%20width='18px'%20fill='%23198754'%3e%3cpath%20d='M0%200h24v24H0z'%20fill='none'/%3e%3cpath%20d='M12%202C6.48%202%202%206.48%202%2012s4.48%2010%2010%2010%2010-4.48%2010-10S17.52%202%2012%202zm-2%2015-5-5%201.41-1.41L10%2014.17l7.59-7.59L19%208l-9%209z'/%3e%3c/svg%3e",D="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='18px'%20viewBox='0%200%2024%2024'%20width='18px'%20fill='%23dc3545'%3e%3cpath%20d='M0%200h24v24H0z'%20fill='none'/%3e%3cpath%20d='M12%202C6.47%202%202%206.47%202%2012s4.47%2010%2010%2010%2010-4.47%2010-10S17.53%202%2012%202zm5%2013.59L15.59%2017%2012%2013.41%208.41%2017%207%2015.59%2010.59%2012%207%208.41%208.41%207%2012%2010.59%2015.59%207%2017%208.41%2013.41%2012%2017%2015.59z'/%3e%3c/svg%3e",M="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='18px'%20viewBox='0%200%2024%2024'%20width='18px'%20fill='%239f9f9f'%3e%3cpath%20d='M0%200h24v24H0z'%20fill='none'/%3e%3cpath%20d='M12%202C6.48%202%202%206.48%202%2012s4.48%2010%2010%2010%2010-4.48%2010-10S17.52%202%2012%202zm5%2011H7v-2h10v2z'/%3e%3c/svg%3e",Ce={data(){return{currentTab:"所有優惠券",currentPageCoupons:[],currentPage:1,coupons:[],validCoupons:[],notYetValidCoupons:[],InvalidCoupons:[],coupon:{},isNew:!0,isLoading:!1,loadingStatus:{loadingGetCoupons:!1,loadingGetCoupon:!1,loadingDelCoupon:""}}},components:{AdCouponModal:xe},methods:{async getCoupons(){try{this.loadingStatus.loadingGetCoupons=!0,this.coupons=[],this.validCoupons=[],this.InvalidCoupons=[],this.notYetValidCoupons=[],this.currentPageCoupons=[];let o,t;const d="https://ec-course-api.hexschool.io/v2/api/greensheep/admin/coupons",r=await this.$http.get(d);for(this.coupons=r.data.coupons,o=r.data.pagination.current_page+1,t=r.data.pagination.total_pages;o<=t;){const s=await this.$http.get(`${d}?page=${o}`);this.coupons=[...this.coupons,...s.data.coupons],o++}this.filterCoupons(),this.changePage(this.currentPage)}catch(o){w(o.response.data.message)}finally{this.loadingStatus.loadingGetCoupons=!1}},filterCoupons(){this.coupons.forEach(o=>{k("now")>o.start_date&&k("now")<o.due_date?this.validCoupons.push(o):k("now")>o.due_date?this.InvalidCoupons.push(o):k("now")<o.start_date&&this.notYetValidCoupons.push(o)})},changePage(o){switch(this.currentTab){case"所有優惠券":this.currentPageCoupons=this.coupons.slice((o-1)*10,o*10);break;case"有效":this.currentPageCoupons=this.validCoupons.slice((o-1)*10,o*10);break;case"尚未生效":this.currentPageCoupons=this.notYetValidCoupons.slice((o-1)*10,o*10);break;case"已失效":this.currentPageCoupons=this.InvalidCoupons.slice((o-1)*10,o*10);break}j()},changeTab(o){this.currentTab=o,this.currentPage=1,this.changePage(this.currentPage)},async getCoupon(o){try{this.loadingStatus.loadingGetCoupon=!0;const d=await this.$http.get("https://ec-course-api.hexschool.io/v2/api/greensheep/admin/coupons");this.coupon=d.data.coupons.find(r=>r.id===o),this.loadingStatus.loadingGetCoupon=!1}catch(t){w(t.response.data.message)}finally{this.loadingStatus.loadingGetCoupon=!1}},updateCoupon(o){this.loadingStatus.loadingGetCoupon=!0;const t={title:o.title,is_enabled:1,percent:o.title==="金額折抵"?100:o.percent,start_date:o.dates[0]/1e3,due_date:o.dates[1]/1e3,code:o.code};if(o.title==="金額折抵"?(t.min_buy_price_by_price=o.min_buy_price_by_price,t.discount_price=o.discount_price):o.title==="訂單折扣"&&(t.min_buy_price_by_discount=o.min_buy_price_by_discount),this.isNew)this.$http.post("https://ec-course-api.hexschool.io/v2/api/greensheep/admin/coupon",{data:t}).then(r=>{P(r.data.message),this.$refs.adCouponModal.closeModal(),this.getCoupons()}).catch(r=>{w(r.response.data.message)}).finally(()=>{this.loadingStatus.loadingGetCoupon=!1});else if(!this.isNew){const r=`https://ec-course-api.hexschool.io/v2/api/greensheep/admin/coupon/${o.id}`;this.$http.put(r,{data:t}).then(s=>{P(s.data.message),this.$refs.adCouponModal.closeModal(),this.getCoupons()}).catch(s=>{w(s.response.data.message)}).finally(()=>{this.loadingStatus.loadingGetCoupon=!1})}},deleteCoupon(o){this.loadingStatus.loadingDelCoupon=o;const t=`https://ec-course-api.hexschool.io/v2/api/greensheep/admin/coupon/${o}`;this.$http.delete(t).then(d=>{P(d.data.message),this.getCoupons()}).catch(d=>{w(d.response.data.message)}).finally(()=>{this.loadingStatus.loadingDelCoupon=""})},async openModal(o,t){switch(o){case"new":this.isNew=!0,this.coupon={title:"金額折抵"},this.$refs.adCouponModal.openModal();break;case"edit":this.isNew=!1,this.$refs.adCouponModal.openModal(),await this.getCoupon(t);break}},unixToDate(o){const t=o*1e3;return B(t)},dateToUnix(o="now"){return k(o)}},mounted(){this.getCoupons()}},ke={class:"ad-coupon px-lg-10 pt-3 pt-lg-10 text-start"},we=e("h1",{class:"fs-3 mb-4 fw-bold"},"優惠管理",-1),Ve={class:"nav flex-nowrap text-nowrap overflow-x-scroll overflow-x-sm-auto border-bottom border-primary mb-4"},Te={class:"nav-item"},De={class:"nav-item"},Me={class:"nav-item"},Se={class:"nav-item"},Pe={class:"table-container table-responsive d-none d-lg-block"},Ne={class:"table align-middle text-nowrap mb-4"},Ue=e("thead",{class:"table-head position-relative"},[e("tr",null,[e("th",{style:{width:"15%"}},"優惠碼"),e("th",{style:{width:"30%"}},"優惠型式"),e("th",{style:{width:"15%"}},"開始日期"),e("th",{style:{width:"15%"}},"結束日期"),e("th",{style:{width:"15%"}},"狀態"),e("th",{style:{width:"5%"}}),e("th",{style:{width:"5%"}})])],-1),Fe={class:"py-5"},Ge={class:"fw-bold mb-4"},Le={key:0},ze={key:1},Be={key:0,class:"text-success"},Re=e("img",{src:T,alt:"有效",class:"align-top"},null,-1),je={key:1,class:"text-danger"},qe=e("img",{src:D,alt:"已失效",class:"align-top"},null,-1),We={key:2},Ye=e("img",{src:M,alt:"已失效",class:"align-top"},null,-1),Ee={key:1,class:"text-success"},Ie=e("img",{src:T,alt:"有效",class:"align-top"},null,-1),Ae={key:2},He=e("img",{src:M,alt:"已失效",class:"align-top"},null,-1),Ke={key:3,class:"text-danger"},Oe=e("img",{src:D,alt:"已失效",class:"align-top"},null,-1),Je=["onClick"],Qe=e("i",{class:"bi bi-pencil-fill text-dark fs-6"},null,-1),Xe=[Qe],Ze={class:"d-flex align-items-center"},$e=["onClick"],et=e("i",{class:"bi bi-trash3-fill text-dark fs-6"},null,-1),tt=[et],st={key:0,class:"spinner-border spinner-border-sm",role:"status"},ot=e("span",{class:"visually-hidden"},"Loading...",-1),nt=[ot],at={class:"row list-unstyled text-dark d-lg-none",style:{"row-gap":"12px"}},it={class:"border border-primary rounded overflow-hidden"},lt={class:"row g-0"},dt={class:"col-12"},ct={class:"bg-primary d-flex justify-content-between align-items-center px-2 py-2"},rt={class:"bg-primary text-white fw-bold"},ut={class:"text-end bg-white rounded-pill px-2 py-1 fs-8"},pt={key:0,class:"text-success"},_t=e("img",{src:T,alt:"有效",class:"align-top"},null,-1),ht={key:1,class:"text-danger"},mt=e("img",{src:D,alt:"已失效",class:"align-top"},null,-1),gt={key:2},bt=e("img",{src:M,alt:"已失效",class:"align-top"},null,-1),ft={key:1,class:"text-success"},vt=e("img",{src:T,alt:"有效",class:"align-top"},null,-1),yt={key:2},xt=e("img",{src:M,alt:"已失效",class:"align-top"},null,-1),Ct={key:3,class:"text-danger"},kt=e("img",{src:D,alt:"已失效",class:"align-top"},null,-1),wt={class:"col-12"},Vt={class:"px-2 py-2 border-bottom border-primary"},Tt={class:"fw-bold mb-2"},Dt={key:0},Mt={key:1},St={class:"col-9"},Pt={class:"px-2 py-2"},Nt={class:"col-3"},Ut={class:"d-flex justify-content-between justify-content-sm-evenly pe-4 py-2"},Ft=["onClick"],Gt=e("i",{class:"bi bi-pencil-fill text-dark fs-6"},null,-1),Lt=[Gt],zt=["onClick"],Bt=e("i",{class:"bi bi-trash3-fill text-dark fs-6"},null,-1),Rt={key:0,class:"spinner-border spinner-border-sm",role:"status"},jt=e("span",{class:"visually-hidden"},"Loading...",-1),qt=[jt],Wt={class:"text-center va-pagination"},Yt=e("span",{class:"material-icons fs-8 p-1"}," navigate_before ",-1),Et=e("span",{class:"material-icons fs-8 p-1"}," navigate_next ",-1),It=e("span",{class:"material-icons fs-8 p-1"}," navigate_before ",-1),At=e("span",{class:"material-icons fs-8 p-1"}," navigate_next ",-1),Ht=e("span",{class:"material-icons fs-8 p-1"}," navigate_before ",-1),Kt=e("span",{class:"material-icons fs-8 p-1"}," navigate_next ",-1),Ot=e("span",{class:"material-icons fs-8 p-1"}," navigate_before ",-1),Jt=e("span",{class:"material-icons fs-8 p-1"}," navigate_next ",-1),Qt={key:0,class:"d-flex justify-content-center align-items-center",style:{"min-height":"360px"}},Xt=e("div",{class:"spinner-border",role:"status"},[e("span",{class:"visually-hidden"},"Loading...")],-1),Zt=[Xt];function $t(o,t,d,r,s,i){const g=C("vue-awesome-paginate"),y=C("VueLoading"),S=C("AdCouponModal");return a(),l(x,null,[e("div",ke,[we,e("ul",Ve,[e("li",Te,[e("a",{class:m(["nav-link px-6 py-4",{active:s.currentTab==="所有優惠券"}]),href:"#",onClick:t[0]||(t[0]=v(n=>i.changeTab("所有優惠券"),["prevent"]))}," 所有優惠券 ",2)]),e("li",De,[e("a",{class:m(["nav-link px-6 py-4",{active:s.currentTab==="有效"}]),href:"#",onClick:t[1]||(t[1]=v(n=>i.changeTab("有效"),["prevent"]))}," 有效 ",2)]),e("li",Me,[e("a",{class:m(["nav-link px-6 py-4",{active:s.currentTab==="尚未生效"}]),href:"#",onClick:t[2]||(t[2]=v(n=>i.changeTab("尚未生效"),["prevent"]))}," 尚未生效 ",2)]),e("li",Se,[e("a",{class:m(["nav-link px-6 py-4",{active:s.currentTab==="已失效"}]),href:"#",onClick:t[3]||(t[3]=v(n=>i.changeTab("已失效"),["prevent"]))}," 已失效 ",2)])]),e("a",{href:"#",class:"btn btn-primary mb-4",onClick:t[4]||(t[4]=v(n=>i.openModal("new"),["prevent"]))},"新增優惠券"),e("div",Pe,[e("table",Ne,[Ue,e("tbody",null,[(a(!0),l(x,null,N(s.currentPageCoupons,n=>(a(),l("tr",{key:n.id},[e("td",null,u(n.code),1),e("td",Fe,[e("p",Ge,u(n.title),1),n.title==="金額折抵"?(a(),l("p",Le," 消費滿 NT$ "+u(n.min_buy_price_by_price)+"，享 NT$ "+u(n.discount_price)+" 折扣 ",1)):p("",!0),n.title==="訂單折扣"?(a(),l("p",ze," 消費滿 NT$ "+u(n.min_buy_price_by_discount)+"，享 "+u(n.percent%10?n.percent:n.percent/10)+" 折 ",1)):p("",!0)]),e("td",null,u(i.unixToDate(n.start_date)),1),e("td",null,u(i.unixToDate(n.due_date)),1),e("td",null,[s.currentTab==="所有優惠券"?(a(),l(x,{key:0},[i.dateToUnix()>n.start_date&&i.dateToUnix()<n.due_date?(a(),l("span",Be,[h(" 有效 "),Re])):p("",!0),i.dateToUnix()>n.due_date?(a(),l("span",je,[h(" 已失效 "),qe])):p("",!0),i.dateToUnix()<n.start_date?(a(),l("span",We,[h(" 尚未生效 "),Ye])):p("",!0)],64)):s.currentTab==="有效"?(a(),l("span",Ee,[h(" 有效 "),Ie])):s.currentTab==="尚未生效"?(a(),l("span",Ae,[h(" 尚未生效 "),He])):s.currentTab==="已失效"?(a(),l("span",Ke,[h(" 已失效 "),Oe])):p("",!0)]),e("td",null,[e("a",{href:"#",class:m({"disabled-link":s.loadingStatus.loadingDelCoupon}),onClick:v(f=>i.openModal("edit",n.id),["prevent"])},Xe,10,Je)]),e("td",null,[e("div",Ze,[e("a",{href:"#",class:m({"disabled-link":s.loadingStatus.loadingDelCoupon}),onClick:v(f=>i.deleteCoupon(n.id),["prevent"])},tt,10,$e),s.loadingStatus.loadingDelCoupon===n.id?(a(),l("div",st,nt)):p("",!0)])])]))),128))])])]),e("ul",at,[(a(!0),l(x,null,N(s.currentPageCoupons,n=>(a(),l("li",{class:"col-12",key:n.id},[e("div",it,[e("div",lt,[e("div",dt,[e("div",ct,[e("div",rt,u(n.code),1),e("div",ut,[s.currentTab==="所有優惠券"?(a(),l(x,{key:0},[i.dateToUnix()>n.start_date&&i.dateToUnix()<n.due_date?(a(),l("span",pt,[h(" 有效 "),_t])):p("",!0),i.dateToUnix()>n.due_date?(a(),l("span",ht,[h(" 已失效 "),mt])):p("",!0),i.dateToUnix()<n.start_date?(a(),l("span",gt,[h(" 尚未生效 "),bt])):p("",!0)],64)):s.currentTab==="有效"?(a(),l("span",ft,[h(" 有效 "),vt])):s.currentTab==="尚未生效"?(a(),l("span",yt,[h(" 尚未生效 "),xt])):s.currentTab==="已失效"?(a(),l("span",Ct,[h(" 已失效 "),kt])):p("",!0)])])]),e("div",wt,[e("div",Vt,[e("p",Tt,u(n.title),1),n.title==="金額折抵"?(a(),l("p",Dt," 消費滿 NT$ "+u(n.min_buy_price_by_price)+"，享 NT$ "+u(n.discount_price)+" 折扣 ",1)):p("",!0),n.title==="訂單折扣"?(a(),l("p",Mt," 消費滿 NT$ "+u(n.min_buy_price_by_discount)+"，享 "+u(n.percent%10?n.percent:n.percent/10)+" 折 ",1)):p("",!0)])]),e("div",St,[e("p",Pt,u(i.unixToDate(n.start_date))+" 至 "+u(i.unixToDate(n.due_date)),1)]),e("div",Nt,[e("div",Ut,[e("a",{href:"#",class:m({"disabled-link":s.loadingStatus.loadingDelCoupon}),onClick:v(f=>i.openModal("edit",n.id),["prevent"])},Lt,10,Ft),e("a",{href:"#",class:m({"disabled-link":s.loadingStatus.loadingDelCoupon}),onClick:v(f=>i.deleteCoupon(n.id),["prevent"])},[Bt,s.loadingStatus.loadingDelCoupon===n.id?(a(),l("div",Rt,qt)):p("",!0)],10,zt)])])])])]))),128))]),e("div",Wt,[s.currentTab==="所有優惠券"&&!s.loadingStatus.loadingGetCoupons?(a(),V(g,{key:0,"total-items":s.coupons.length,"items-per-page":10,"max-pages-shown":3,modelValue:s.currentPage,"onUpdate:modelValue":t[5]||(t[5]=n=>s.currentPage=n),onClick:i.changePage,"pagination-container-class":"cus-pagination","paginate-buttons-class":"page-link","number-buttons-class":"fs-8","active-page-class":"active"},{"prev-button":b(()=>[Yt]),"next-button":b(()=>[Et]),_:1},8,["total-items","modelValue","onClick"])):s.currentTab==="有效"&&!s.loadingStatus.loadingGetCoupons?(a(),V(g,{key:1,"total-items":s.validCoupons.length,"items-per-page":10,"max-pages-shown":3,modelValue:s.currentPage,"onUpdate:modelValue":t[6]||(t[6]=n=>s.currentPage=n),onClick:i.changePage,"pagination-container-class":"cus-pagination","paginate-buttons-class":"page-link","number-buttons-class":"fs-8","active-page-class":"active"},{"prev-button":b(()=>[It]),"next-button":b(()=>[At]),_:1},8,["total-items","modelValue","onClick"])):s.currentTab==="尚未生效"&&!s.loadingStatus.loadingGetCoupons?(a(),V(g,{key:2,"total-items":s.notYetValidCoupons.length,"items-per-page":10,"max-pages-shown":3,modelValue:s.currentPage,"onUpdate:modelValue":t[7]||(t[7]=n=>s.currentPage=n),onClick:i.changePage,"pagination-container-class":"cus-pagination","paginate-buttons-class":"page-link","number-buttons-class":"fs-8","active-page-class":"active"},{"prev-button":b(()=>[Ht]),"next-button":b(()=>[Kt]),_:1},8,["total-items","modelValue","onClick"])):s.currentTab==="已失效"&&!s.loadingStatus.loadingGetCoupons?(a(),V(g,{key:3,"total-items":s.InvalidCoupons.length,"items-per-page":10,"max-pages-shown":3,modelValue:s.currentPage,"onUpdate:modelValue":t[8]||(t[8]=n=>s.currentPage=n),onClick:i.changePage,"pagination-container-class":"cus-pagination","paginate-buttons-class":"page-link","number-buttons-class":"fs-8","active-page-class":"active"},{"prev-button":b(()=>[Ot]),"next-button":b(()=>[Jt]),_:1},8,["total-items","modelValue","onClick"])):p("",!0)]),s.loadingStatus.loadingGetCoupons?(a(),l("div",Qt,Zt)):p("",!0)]),_(y,{active:s.isLoading},null,8,["active"]),_(S,{ref:"adCouponModal",coupon:s.coupon,isNew:s.isNew,loadingStatus:s.loadingStatus,onUpdateCoupon:i.updateCoupon},null,8,["coupon","isNew","loadingStatus","onUpdateCoupon"])],64)}const ls=L(Ce,[["render",$t]]);export{ls as default};
