import{y as g,z as a,_ as O,m as b,a as P,c as m,b as s,t as c,F as w,r as x,o as p,e as v}from"./index-Dsh4BMs7.js";import{S as u}from"./sweetalert2.all-COr3l8HE.js";var y={VITE_APP_API_URL:"https://ec-course-api.hexschool.io/v2",VITE_APP_API_NAME:"greensheep",BASE_URL:"/greensheep/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_API_URL:l,VITE_APP_API_NAME:i}=y,f=g("orderStore",{state:()=>({allOrders:[],unpaidOrders:[],paidOrders:[],deletedOrders:[],doneOrders:[]}),actions:{async getAllOrders(){try{this.allOrders=[],this.unpaidOrders=[],this.paidOrders=[];const t=`${l}/api/${i}/admin/orders`,o=await a.get(t);this.allOrders=o.data.orders,this.allOrders.forEach(e=>{e.orderStatus||(e.orderStatus={getOrder:!0,making:!1,sendProduct:!1,done:!1}),e.is_deleted?this.deletedOrders.push(e):e.is_paid?this.paidOrders.push(e):this.unpaidOrders.push(e),e.orderStatus.done&&this.doneOrders.push(e)})}catch(t){console.log(t)}},updateOrder(t){const o=`${l}/api/${i}/admin/order/${t.id}`;t.orderStatus=this.orderStatus,a.put(o,{data:t}).then(()=>{u.fire({position:"top-end",icon:"success",title:"訂單修改成功",showConfirmButton:!1,toast:!0,timer:1500}),location.reload()}).catch(e=>{console.log(e)})},deleteOrder(t){const o=`${l}/api/${i}/admin/order/${t.id}`;u.fire({title:"是否刪除該訂單?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#566b5a",cancelButtonText:"  否  ",confirmButtonText:"  是  "}).then(e=>{e.isConfirmed&&(console.log("delete"),t.is_deleted=!0,a.put(o,{data:t}).then(r=>{console.log(r),location.reload()}).catch(r=>{console.log(r)}))}),console.log(t)},recoverDelete(t){const o=`${l}/api/${i}/admin/order/${t.id}`;t.is_deleted=!1,a.put(o,{data:t}).then(e=>{console.log(e),location.reload(),console.log("Rocover Delete")}).catch(e=>{console.log(e)})},confirmDelete(t){const o=`${l}/api/${i}/admin/order/${t}`;u.fire({title:"確認永久刪除該訂單?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#566b5a",cancelButtonText:"  否  ",confirmButtonText:"  是  "}).then(e=>{e.isConfirmed&&a.delete(o).then(()=>{location.reload()}).catch(r=>{console.log(r)})})},deleteAllOrders(){const t=`${l}/api/${i}/admin/orders/all`;u.fire({title:"確認永久刪除全部訂單?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#566b5a",cancelButtonText:"  否  ",confirmButtonText:"  是  "}).then(o=>{o.isConfirmed&&a.delete(t).then(()=>{location.reload()}).catch(e=>{console.log(e)})})}}}),B={data(){return{orderCreateTime:null,passedTime:null,homeOrderInfo:[]}},methods:{...b(f,["getAllOrders","getNewOrders"]),toOrderPage(){this.$router.push("/admin/orders")},getHomeOrders(){console.log("3",this.allOrders,this.unpaidOrders);const t=Math.floor(new Date().getTime()/1e3);console.log(t);const o=this.unpaidOrders.map(e=>({id:e.create_at,createTime:e.create_at,passedTime:this.calculatePassedTime(t,e.create_at)}));this.homeOrderInfo=o},calculatePassedTime(t,o){const e=t-o;if(e<60)return e+"秒前";if(e>=60&&e<60*60)return Math.floor(e/60)+"分鐘前";if(e>=60*60&&e<24*60*60)return Math.floor(e/3600)+"小時前";{const r=Math.floor(e/86400),h=Math.floor(e%(24*60*60)/(60*60));return r+"天"+h+"小時前"}}},computed:{...P(f,["allOrders","unpaidOrders","paidOrders","deletedOrders","doneOrders"])},async mounted(){await this.getAllOrders(),this.getHomeOrders()}},T={class:"container px-3 px-lg-10 mt-8 mt-lg-10 mb-7 mb-lg-10"},A={class:"row"},C={class:"col-12 col-lg-5 mb-9"},S=s("h1",{class:"display-3 fw-bold mb-4 text-start"},"待辦清單",-1),$={class:"d-flex"},k={class:"w-50 bg-white m-2"},I={class:"py-8"},E={class:"d-block fs-2 mb-3 text-primary fw-medium"},U=s("span",{class:"d-block fs-6 mb-3 text-primary"},"全部訂單",-1),D={class:"w-50 bg-white m-2"},M={class:"py-8"},V={class:"d-block fs-2 mb-3 text-primary fw-medium"},R=s("span",{class:"d-block fs-6 mb-3 text-primary"},"待付款訂單",-1),N={class:"col-12 col-lg-7"},H=s("h2",{class:"display-3 fw-bold mb-4 text-start"},"通知",-1),L={class:"d-flex"},F={class:"notice-board w-100 bg-white m-2"},G={class:"p-3"},z={class:"card-body p-3 text-start cursor-pointer"},j={class:"fs-6 text-dark fw-medium font-notosans mb-3"},q=s("span",{class:"float-end"},[s("i",{class:"bi bi-exclamation-circle-fill text-danger"})],-1),J={class:"fs-7 text-primary"};function K(t,o,e,r,h,n){return p(),m("div",T,[s("div",A,[s("div",C,[S,s("div",$,[s("div",k,[s("div",I,[s("span",E,c(t.allOrders.length),1),U]),s("button",{type:"button ",class:"custom-btn custom-btn-toGreen w-100",onClick:o[0]||(o[0]=(...d)=>n.toOrderPage&&n.toOrderPage(...d))}," 查看詳情 ")]),s("div",D,[s("div",M,[s("span",V,c(t.unpaidOrders.length),1),R]),s("button",{type:"button ",class:"custom-btn custom-btn-toGreen w-100",onClick:o[1]||(o[1]=(...d)=>n.toOrderPage&&n.toOrderPage(...d))}," 查看詳情 ")])])]),s("div",N,[H,s("div",L,[s("div",F,[s("div",G,[(p(!0),m(w,null,x(h.homeOrderInfo,d=>(p(),m("div",{key:d.id,class:"card border border-primary rounded-3 mb-4",onClick:o[2]||(o[2]=(..._)=>n.toOrderPage&&n.toOrderPage(..._))},[s("div",z,[s("div",j,[v(" 訂單編號："+c(d.id)+" ",1),q]),s("p",J," 恭喜你！"+c(d.passedTime)+" 收到一筆新訂單喔！ ",1)])]))),128))])])])])])])}const X=O(B,[["render",K]]);export{X as default};
