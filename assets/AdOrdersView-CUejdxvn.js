import{_ as z,o as c,c as r,r as D,b as e,e as P,t as d,x as m,i as f,F as S,f as G,z as u,d as x,g as O,P as w,O as H,l as J,j as K,v as Q}from"./index-DOG-Oquy.js";import{S as k}from"./sweetalert2.all-U9J17dpM.js";const W={props:["orders","openModal","deleteOrder","confirmDelete"]},X={class:"accordion-header"},Y=["data-bs-target"],Z={key:0,class:"ms-10 badge rounded-pill text-bg-primary fs-7"},ee={key:1,class:"ms-10 badge rounded-pill text-bg-danger fs-7"},te=["id"],se={class:"accordion-body"},oe={class:"ms-7 d-flex align-items-center"},ae={class:"badge rounded-pill text-bg-primary fs-7 m-2"},le={class:"me-7 d-flex"},de={class:"mx-3"},ne=e("div",{class:"my-4 border border-1"},null,-1),ie={class:"d-flex justify-content-between mx-4"},ce={class:""},re={class:"ms-2 fs-6 badge rounded-pill text-bg-secondary"},be={class:""},_e=e("div",{class:"my-4 border border-3"},null,-1),ue={class:"mt-4"},he={class:"fs-4"},pe={class:"m-2"},me={class:"m-2"},fe={class:"m-2"},ge={class:"m-2"},ve={class:"m-2"},ye=["onClick"],xe=["onClick"],Oe=["onClick"];function ke(l,o,a,_,t,i){return c(!0),r(S,null,D(a.orders,s=>{var g,v,y;return c(),r("div",{class:"accordion-item my-5",key:s.id},[e("h2",X,[e("button",{class:"accordion-button fs-7",type:"button","data-bs-toggle":"collapse","data-bs-target":`#${s.id}`,"aria-expanded":"true","aria-controls":"panelsStayOpen-collapseOne"},[P(d(s.create_at)+" | "+d(s.id)+" ",1),e("span",{class:m([s.is_paid?"text-bg-primary":"text-bg-danger","ms-10 badge rounded-pill text-bg-primary fs-7"])},d(s.is_paid?"已付款":"未付款"),3),(g=s==null?void 0:s.orderStatus)!=null&&g.done?(c(),r("span",Z,"已完成")):f("",!0),s!=null&&s.is_deleted?(c(),r("span",ee,"已刪除")):f("",!0)],8,Y)]),e("div",{id:s.id,class:"accordion-collapse collapse show"},[e("div",se,[(c(!0),r(S,null,D(Object.values(s.products),b=>(c(),r("div",{class:"border-bottom border-light d-flex align-items-center justify-content-between my-2",key:b.id},[e("div",oe,[e("span",ae,d(b.product.category),1),e("h3",null,d(b.product.title)+" ("+d(b.product.id)+")",1)]),e("div",le,[e("span",de,"數量："+d(b.qty),1),e("p",null," 總價："+d(b.total),1)])]))),128)),ne,e("div",ie,[e("p",ce,[P("優惠券："),e("span",re,d((y=(v=Object.values(s.products)[0])==null?void 0:v.coupon)==null?void 0:y.code),1)]),e("p",be,"總金額："+d(parseInt(s.total)),1)]),_e,e("div",ue,[e("div",he,[e("p",pe,"客戶姓名："+d(s.user.name),1),e("p",me,"客戶電話："+d(s.user.tel),1),e("p",fe,"客戶地址："+d(s.user.address),1),e("p",ge,"客戶Email："+d(s.user.email),1),e("p",ve,"備註："+d(s.message),1),e("button",{type:"button",class:"btn btn-primary","data-bs-toggle":"modal","data-bs-target":"#adOrderModal",onClick:b=>a.openModal(s)}," 修改訂單 ",8,ye),s.is_deleted?f("",!0):(c(),r("button",{key:0,type:"button",class:"mx-4 btn btn-danger","data-bs-target":"#adOrderModal",onClick:b=>a.deleteOrder(s)}," 刪除訂單 ",8,xe)),s.is_deleted?(c(),r("button",{key:1,class:"btn btn-danger mx-4",onClick:G(b=>a.confirmDelete(s.id),["prevent"])},"確認永久刪除訂單",8,Oe)):f("",!0)])])])],8,te)])}),128)}const Se=z(W,[["render",ke]]);var we={VITE_APP_API_URL:"https://ec-course-api.hexschool.io/v2",VITE_APP_API_NAME:"greensheep",BASE_URL:"/greensheep/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_API_URL:h,VITE_APP_API_NAME:p}=we,De={components:{Accordion:Se},data(){return{allOrders:[],unpaidOrders:[],paidOrders:[],deletedOrders:[],doneOrders:[],modalData:{},modalProducts:[],orderStatus:{getOrder:!0,making:!1,sendProduct:!1,done:!1}}},methods:{getAllOrders(){this.allOrders=[],this.unpaidOrders=[],this.paidOrders=[];const l=`${h}/api/${p}/admin/orders`;u.get(l).then(o=>{this.allOrders=o.data.orders,this.allOrders.forEach(a=>{a.orderStatus||(a.orderStatus={getOrder:!0,making:!1,sendProduct:!1,done:!1}),a.is_deleted?this.deletedOrders.push(a):a.is_paid?this.paidOrders.push(a):this.unpaidOrders.push(a),a.orderStatus.done&&this.doneOrders.push(a)})}).catch(o=>{console.log(o)})},updateOrder(l){const o=`${h}/api/${p}/admin/order/${l.id}`;l.orderStatus=this.orderStatus,u.put(o,{data:l}).then(()=>{k.fire({position:"top-end",icon:"success",title:"訂單修改成功",showConfirmButton:!1,toast:!0,timer:1500}),location.reload()}).catch(a=>{console.log(a)})},deleteOrder(l){const o=`${h}/api/${p}/admin/order/${l.id}`;k.fire({title:"是否刪除該訂單?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#566b5a",cancelButtonText:"  否  ",confirmButtonText:"  是  "}).then(a=>{a.isConfirmed&&(console.log("delete"),l.is_deleted=!0,u.put(o,{data:l}).then(_=>{console.log(_),location.reload()}).catch(_=>{console.log(_)}))}),console.log(l)},recoverDelete(l){const o=`${h}/api/${p}/admin/order/${l.id}`;l.is_deleted=!1,u.put(o,{data:l}).then(a=>{console.log(a),location.reload(),console.log("Rocover Delete")}).catch(a=>{console.log(a)})},confirmDelete(l){const o=`${h}/api/${p}/admin/order/${l}`;console.log(l),k.fire({title:"確認永久刪除該訂單?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#566b5a",cancelButtonText:"  否  ",confirmButtonText:"  是  "}).then(a=>{a.isConfirmed&&u.delete(o).then(()=>{location.reload()}).catch(_=>{console.log(_)})})},deleteAllOrders(){const l=`${h}/api/${p}/admin/orders/all`;k.fire({title:"確認永久刪除全部訂單?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#566b5a",cancelButtonText:"  否  ",confirmButtonText:"  是  "}).then(o=>{o.isConfirmed&&u.delete(l).then(()=>{location.reload()}).catch(a=>{console.log(a)})})},openModal(l){this.modalData={...l},this.modalProducts=Object.values(l.products),this.orderStatus=l.orderStatus}},mounted(){this.getAllOrders()}},Pe={class:"container px-10 pt-10 text-start"},Me=e("h1",{class:"fs-3 mb-4"},"訂單管理",-1),Ce=e("nav",null,[e("div",{class:"nav nav-tabs border-button border-3",id:"nav-tab",role:"tablist"},[e("button",{class:"nav-link active w-10",id:"nav-home-tab","data-bs-toggle":"tab","data-bs-target":"#allOrders",type:"button",role:"tab","aria-controls":"nav-home","aria-selected":"true"},"全部訂單"),e("button",{class:"nav-link w-10",id:"nav-profile-tab","data-bs-toggle":"tab","data-bs-target":"#unpaid",type:"button",role:"tab","aria-controls":"nav-profile","aria-selected":"false"},"未付款"),e("button",{class:"nav-link w-10",id:"nav-contact-tab","data-bs-toggle":"tab","data-bs-target":"#paid",type:"button",role:"tab","aria-controls":"nav-contact","aria-selected":"false"},"已付款"),e("button",{class:"nav-link w-10",id:"nav-contact-tab","data-bs-toggle":"tab","data-bs-target":"#delete",type:"button",role:"tab","aria-controls":"nav-contact","aria-selected":"false"},"已刪除"),e("button",{class:"nav-link w-10",id:"nav-contact-tab","data-bs-toggle":"tab","data-bs-target":"#done",type:"button",role:"tab","aria-controls":"nav-contact","aria-selected":"false"},"已完成")])],-1),Ae={class:"tab-content m-3",id:"nav-tabContent"},Be={class:"tab-pane fade show active",id:"allOrders",role:"tabpanel","aria-labelledby":"nav-home-tab",tabindex:"0"},Ee={class:"accordion",id:"accordionPanelsStayOpenExample"},Ve={class:"tab-pane fade",id:"unpaid",role:"tabpanel","aria-labelledby":"nav-profile-tab",tabindex:"0"},Ue={class:"accordion",id:"accordionPanelsStayOpenExample"},Te={class:"tab-pane fade",id:"paid",role:"tabpanel","aria-labelledby":"nav-contact-tab",tabindex:"0"},je={class:"accordion",id:"accordionPanelsStayOpenExample"},Ie={class:"tab-pane fade",id:"delete",role:"tabpanel","aria-labelledby":"nav-contact-tab",tabindex:"0"},Ne={class:"accordion",id:"accordionPanelsStayOpenExample"},Re={class:"tab-pane fade",id:"done",role:"tabpanel","aria-labelledby":"nav-contact-tab",tabindex:"0"},Le={class:"accordion",id:"accordionPanelsStayOpenExample"},$e={class:"modal fade rounded-2",id:"adOrderModal","data-bs-keyboard":"false",tabindex:"-1","aria-hidden":"true"},qe={class:"modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable"},ze={class:"modal-content"},Fe=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-4 ms-2",id:"staticBackdropLabel"},"訂單詳細資料"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Ge={class:"modal-body"},He={class:""},Je={class:"p-10 d-flex justify-content-center",style:{"z-index":"10"}},Ke=J('<div class=""><input type="checkbox" class="btn-check" id="btncheck1" autocomplete="off" checked disabled><label class="btn btn-outline-primary border-2 rounded-circle" for="btncheck1"><i class="bi bi-check-lg fs-2 text-light"></i></label><p class="mt-3 fs-4">收到訂單</p></div>',1),Qe={class:""},We=["disabled"],Xe=e("label",{class:"btn btn-outline-primary border-2 rounded-circle",for:"btncheck2"},[e("i",{class:"bi bi-check-lg fs-2 text-light"})],-1),Ye=e("p",{class:"mt-3 fs-4"},"製作中",-1),Ze={class:""},et=["disabled"],tt=e("i",{class:"bi bi-check-lg fs-2 text-light"},null,-1),st=[tt],ot=e("p",{class:"mt-3 fs-4"},"已出貨",-1),at={class:""},lt=["disabled"],dt=e("i",{class:"bi bi-check-lg fs-2 text-light"},null,-1),nt=[dt],it=e("p",{class:"mt-3 fs-4"},"已完成",-1),ct={class:""},rt=e("h3",{class:"text-center"},"客戶資料",-1),bt={class:"border border-light text-start w-75 mx-auto"},_t={class:"m-2"},ut={class:"m-2"},ht={class:"m-2"},pt={class:"m-2"},mt=e("label",{for:"payState",class:"fs-5 text-primary m-2"},"付款狀態：",-1),ft=["disabled"],gt=e("option",{value:!1},"未付款",-1),vt=e("option",{value:!0},"已付款",-1),yt=[gt,vt],xt=e("h3",{class:"mb-3 mt-6"},"訂單商品",-1),Ot={class:"table align-middle border-primary"},kt=e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"text-primary fw-medium"},"商品資訊"),e("th",{scope:"col",class:"text-primary fw-medium"},"數量"),e("th",{scope:"col",class:"text-primary fw-medium"},"價格"),e("th",{scope:"col",class:"text-primary fw-medium"})])],-1),St={scope:"row",class:"py-4"},wt={class:"card border-0 h-10",style:{"max-width":"540px"}},Dt={class:"row g-0 align-items-center"},Pt={class:"col-md-4"},Mt={class:"ratio ratio-1x1"},Ct=["src"],At={class:"col-md-8"},Bt={class:"card-body"},Et={class:"fs-6 card-title text-primary fw-medium"},Vt={class:"text-start fw-normal"},Ut={class:"py-4"},Tt=["onUpdate:modelValue"],jt={class:"py-4 text-primary"},It={class:"d-flex justify-content-between mx-4 my-5"},Nt={class:"fs-4"},Rt={key:0,class:"ms-2 fs-5 badge rounded-pill text-bg-warning"},Lt={class:"fs-4 me-4"},$t={class:"modal-footer"},qt=e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"取消",-1);function zt(l,o,a,_,t,i){var g,v,y,b,M,C,A,B,E,V,U,T,j,I,N,R,L,$,q;const s=K("Accordion");return c(),r(S,null,[e("div",Pe,[Me,Ce,e("div",Ae,[e("div",Be,[e("button",{type:"button",class:"btn btn-danger",onClick:o[0]||(o[0]=(...n)=>i.deleteAllOrders&&i.deleteAllOrders(...n))},"刪除全部訂單"),e("div",Ee,[x(s,{orders:t.allOrders,openModal:i.openModal,deleteOrder:i.deleteOrder},null,8,["orders","openModal","deleteOrder"])])]),e("div",Ve,[e("div",Ue,[x(s,{orders:t.unpaidOrders,openModal:i.openModal,deleteOrder:i.deleteOrder},null,8,["orders","openModal","deleteOrder"])])]),e("div",Te,[e("div",je,[x(s,{orders:t.paidOrders,openModal:i.openModal,deleteOrder:i.deleteOrder},null,8,["orders","openModal","deleteOrder"])])]),e("div",Ie,[e("div",Ne,[x(s,{orders:t.deletedOrders,openModal:i.openModal,deleteOrder:i.deleteOrder,confirmDelete:i.confirmDelete},null,8,["orders","openModal","deleteOrder","confirmDelete"])])]),e("div",Re,[e("div",Le,[x(s,{orders:t.doneOrders,openModal:i.openModal,deleteOrder:i.deleteOrder},null,8,["orders","openModal","deleteOrder"])])])])]),e("div",$e,[e("div",qe,[e("div",ze,[Fe,e("div",Ge,[e("div",He,[e("div",Je,[Ke,e("div",{class:m([(g=t.orderStatus)!=null&&g.making?"bg-primary":"bg-light","mt-5"]),style:{height:"10px",width:"20%"}},null,2),e("div",Qe,[O(e("input",{type:"checkbox",class:"btn-check",id:"btncheck2",autocomplete:"off","onUpdate:modelValue":o[1]||(o[1]=n=>t.orderStatus.making=n),disabled:(v=t.orderStatus)==null?void 0:v.sendProduct},null,8,We),[[w,t.orderStatus.making]]),Xe,Ye]),e("div",{class:m(["mt-5",(y=t.orderStatus)!=null&&y.sendProduct?"bg-primary":"bg-light"]),style:{height:"10px",width:"20%"}},null,2),e("div",Ze,[O(e("input",{type:"checkbox",class:"btn-check",id:"btncheck3",autocomplete:"off","onUpdate:modelValue":o[2]||(o[2]=n=>t.orderStatus.sendProduct=n),disabled:!((b=t.orderStatus)!=null&&b.making)||((M=t.orderStatus)==null?void 0:M.done)},null,8,et),[[w,t.orderStatus.sendProduct]]),e("label",{class:m(["btn btn-outline-primary border-2 rounded-circle",t.orderStatus.making?"":"btn-outline-light"]),for:"btncheck3"},st,2),ot]),e("div",{class:m(["mt-5",t.orderStatus.done?"bg-primary":"bg-light"]),style:{height:"10px",width:"20%"}},null,2),e("div",at,[O(e("input",{type:"checkbox",class:"btn-check",id:"btncheck4",autocomplete:"off","onUpdate:modelValue":o[3]||(o[3]=n=>t.orderStatus.done=n),disabled:!t.modalData.is_paid||!t.orderStatus.sendProduct},null,8,lt),[[w,t.orderStatus.done]]),e("label",{class:m(["btn border-2 rounded-circle",[t.modalData.is_paid&&t.orderStatus.sendProduct?"btn-outline-primary":"btn-outline-light"]]),for:"btncheck4"},nt,2),it])])]),e("div",ct,[rt,e("div",bt,[e("h5",_t,"客戶姓名："+d((A=(C=t.modalData)==null?void 0:C.user)==null?void 0:A.name),1),e("h5",ut,"客戶地址："+d((E=(B=t.modalData)==null?void 0:B.user)==null?void 0:E.address),1),e("h5",ht,"客戶Email："+d((U=(V=t.modalData)==null?void 0:V.user)==null?void 0:U.email),1),e("h5",pt,"客戶電話："+d((j=(T=t.modalData)==null?void 0:T.user)==null?void 0:j.tel),1),mt,O(e("select",{class:"form-select d-inline w-25 fs-5",id:"payState","aria-label":"付款狀態","onUpdate:modelValue":o[4]||(o[4]=n=>t.modalData.is_paid=n),disabled:t.orderStatus.done},yt,8,ft),[[H,t.modalData.is_paid]]),(I=t.modalData)!=null&&I.is_deleted?(c(),r("button",{key:0,type:"button",class:"d-flex mx-1 my-1 btn btn-danger","data-bs-target":"#adOrderModal","data-bs-dismiss":"modal",onClick:o[5]||(o[5]=n=>i.recoverDelete(t.modalData))}," 回復刪除 ")):f("",!0)])]),xt,e("table",Ot,[kt,e("tbody",null,[(c(!0),r(S,null,D(t.modalProducts,n=>(c(),r("tr",{key:n.id},[e("th",St,[e("div",wt,[e("div",Dt,[e("div",Pt,[e("div",Mt,[e("img",{src:n.product.imageUrl,class:"img-fluid object-fit-cover",alt:"..."},null,8,Ct)])]),e("div",At,[e("div",Bt,[e("h5",Et,d(n.product.title),1),e("small",Vt,d(n.product.category),1)])])])])]),e("td",Ut,[O(e("input",{type:"number",class:"p-2 w-25",min:"1","onUpdate:modelValue":F=>n.qty=F,disabled:""},null,8,Tt),[[Q,n.qty]])]),e("td",jt,"NT$ "+d(n.total),1)]))),128))])]),e("div",It,[e("p",Nt,[P("優惠券： "),(N=t.modalData)!=null&&N.products?(c(),r("span",Rt,d(($=(L=Object.values((R=t.modalData)==null?void 0:R.products)[0])==null?void 0:L.coupon)==null?void 0:$.code),1)):f("",!0)]),e("p",Lt,"總金額："+d(parseInt((q=t.modalData)==null?void 0:q.total)),1)])]),e("div",$t,[qt,e("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal",onClick:o[6]||(o[6]=n=>i.updateOrder(t.modalData))},"確認修改")])])])])],64)}const Ht=z(De,[["render",zt]]);export{Ht as default};
