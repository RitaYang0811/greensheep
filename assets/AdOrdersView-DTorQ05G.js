import{_ as z,o as r,c,r as C,b as e,f as D,t as d,x as h,j as f,F as w,g as G,z as _,e as x,h as O,P as S,O as H,n as J,k as K,v as Q}from"./index-CtjhObmR.js";import{S as k}from"./sweetalert2.all-D7bwkDQL.js";const W={props:["orders","openModal","deleteOrder","confirmDelete"],data(){return{}},methods:{toggleCollapse(l){this.$refs.collape.forEach(s=>{s.attributes.id.value==l&&s.classList.toggle("hide")})}}},X=["onClick"],Y=["data-bs-target"],Z={key:0,class:"ms-5 badge rounded-pill text-bg-primary fs-8 fw-light"},ee={key:1,class:"ms-5 badge rounded-pill text-bg-danger fs-8 fw-light"},te=["id"],se={class:"accordion-body p-1"},oe={class:"ms-3 d-flex align-items-center"},ae={class:"fw-medium text-grey66 fs-8 m-2"},le={class:"fs-6 fw-medium text-dark"},de={class:"me-7 d-flex text-grey99"},ne={class:"mx-3"},ie=e("div",{class:"my-4 border border-1"},null,-1),re={class:"d-flex justify-content-between mx-4 text-grey66"},ce={class:"ms-1"},be={class:"ms-2 fs-8 text-secondary fw-medium"},ue={class:"text-primary fw-medium"},_e=e("div",{class:"my-4 border"},null,-1),me={class:"mb-4"},pe={class:"fs-6 text-primary ms-3"},he={class:"mx-2 mb-3"},fe={class:"mx-2 mb-3"},ge={class:"mx-2 mb-3"},ve={class:"mx-2 mb-3"},ye={class:"mx-2 mb-3"},xe={class:"d-flex justify-content-end"},Oe=["onClick"],ke=["onClick"],we=["onClick"];function Se(l,s,a,u,t,i){return r(!0),c(w,null,C(a.orders,o=>{var g,v,y;return r(),c("div",{class:"accordion-item my-5 bg-white",key:o.id},[e("h2",{class:"accordion-header",onClick:b=>i.toggleCollapse(o.id)},[e("button",{class:"accordion-button fs-6 fw-bold bg-primary text-white",type:"button","data-bs-toggle":"collapse","data-bs-target":`#${o.id}`,"aria-expanded":"true"},[D(" 訂單編號："+d(o.create_at)+" ",1),e("span",{class:h([o.is_paid?"text-bg-primary":"text-bg-danger","ms-10 badge rounded-pill text-bg-primary fs-8 fw-light"])},d(o.is_paid?"已付款":"未付款"),3),(g=o==null?void 0:o.orderStatus)!=null&&g.done?(r(),c("span",Z,"已完成")):f("",!0),o!=null&&o.is_deleted?(r(),c("span",ee,"已刪除")):f("",!0)],8,Y)],8,X),e("div",{id:o.id,class:"accordion-collapse collapse show",ref_for:!0,ref:"collape"},[e("div",se,[(r(!0),c(w,null,C(Object.values(o.products),b=>(r(),c("div",{class:"d-flex align-items-center justify-content-between my-1",key:b.id},[e("div",oe,[e("span",ae,d(b.product.category)+" / ",1),e("h3",le,d(b.product.title),1)]),e("div",de,[e("span",ne,"數量："+d(b.qty),1),e("p",null,"總價："+d(b.total),1)])]))),128)),ie,e("div",re,[e("p",ce,[D(" 優惠券： "),e("span",be,d((y=(v=Object.values(o.products)[0])==null?void 0:v.coupon)==null?void 0:y.code),1)]),e("p",ue,"總金額：NT$ "+d(parseInt(o.total)),1)]),_e,e("div",me,[e("div",pe,[e("p",he,"客戶姓名："+d(o.user.name),1),e("p",fe,"客戶電話："+d(o.user.tel),1),e("p",ge,"客戶地址："+d(o.user.address),1),e("p",ve,"客戶Email："+d(o.user.email),1),e("p",ye,"備註："+d(o.message),1),e("div",xe,[o.is_deleted?f("",!0):(r(),c("button",{key:0,type:"button",class:"me-4 btn btn-deco","data-bs-target":"#adOrderModal",onClick:b=>a.deleteOrder(o)}," 刪除訂單",8,Oe)),e("button",{type:"button",class:"me-4 btn btn-primary","data-bs-toggle":"modal","data-bs-target":"#adOrderModal",onClick:b=>a.openModal(o)}," 修改訂單 ",8,ke),o.is_deleted?(r(),c("button",{key:1,class:"btn btn-danger me-4",onClick:G(b=>a.confirmDelete(o.id),["prevent"])}," 確認永久刪除訂單 ",8,we)):f("",!0)])])])])],8,te)])}),128)}const Ce=z(W,[["render",Se]]);var De={VITE_APP_API_URL:"https://ec-course-api.hexschool.io/v2",VITE_APP_API_NAME:"greensheep",BASE_URL:"/greensheep/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_API_URL:m,VITE_APP_API_NAME:p}=De,Pe={components:{Accordion:Ce},data(){return{allOrders:[],unpaidOrders:[],paidOrders:[],deletedOrders:[],doneOrders:[],modalData:{},modalProducts:[],orderStatus:{getOrder:!0,making:!1,sendProduct:!1,done:!1}}},computed:{},methods:{getAllOrders(){this.allOrders=[],this.unpaidOrders=[],this.paidOrders=[];const l=`${m}/api/${p}/admin/orders`;_.get(l).then(s=>{this.allOrders=s.data.orders,this.allOrders.forEach(a=>{a.orderStatus||(a.orderStatus={getOrder:!0,making:!1,sendProduct:!1,done:!1}),a.is_deleted?this.deletedOrders.push(a):a.is_paid?this.paidOrders.push(a):this.unpaidOrders.push(a),a.orderStatus.done&&this.doneOrders.push(a)})}).catch(s=>{console.log(s)})},updateOrder(l){const s=`${m}/api/${p}/admin/order/${l.id}`;l.orderStatus=this.orderStatus,_.put(s,{data:l}).then(()=>{k.fire({position:"top-end",icon:"success",title:"訂單修改成功",showConfirmButton:!1,toast:!0,timer:1500}),location.reload()}).catch(a=>{console.log(a)})},deleteOrder(l){const s=`${m}/api/${p}/admin/order/${l.id}`;k.fire({title:"是否刪除該訂單?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#566b5a",cancelButtonText:"  否  ",confirmButtonText:"  是  "}).then(a=>{a.isConfirmed&&(console.log("delete"),l.is_deleted=!0,_.put(s,{data:l}).then(u=>{console.log(u),location.reload()}).catch(u=>{console.log(u)}))}),console.log(l)},recoverDelete(l){const s=`${m}/api/${p}/admin/order/${l.id}`;l.is_deleted=!1,_.put(s,{data:l}).then(a=>{console.log(a),location.reload(),console.log("Rocover Delete")}).catch(a=>{console.log(a)})},confirmDelete(l){const s=`${m}/api/${p}/admin/order/${l}`;k.fire({title:"確認永久刪除該訂單?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#566b5a",cancelButtonText:"  否  ",confirmButtonText:"  是  "}).then(a=>{a.isConfirmed&&_.delete(s).then(()=>{location.reload()}).catch(u=>{console.log(u)})})},deleteAllOrders(){const l=`${m}/api/${p}/admin/orders/all`;k.fire({title:"確認永久刪除全部訂單?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#566b5a",cancelButtonText:"  否  ",confirmButtonText:"  是  "}).then(s=>{s.isConfirmed&&_.delete(l).then(()=>{location.reload()}).catch(a=>{console.log(a)})})},openModal(l){this.modalData={...l},this.modalProducts=Object.values(l.products),this.orderStatus={...l.orderStatus}}},mounted(){this.getAllOrders()}},Me={class:"container text-start px-3 px-lg-10 mt-8 mt-lg-10 mb-7 mb-lg-10"},Ae=e("h1",{class:"fs-3 mb-4 fw-bold"},"訂單管理",-1),Be=e("nav",null,[e("div",{class:"nav nav-tabs border-button border-3",id:"nav-tab",role:"tablist"},[e("button",{class:"nav-link active w-10",id:"nav-home-tab","data-bs-toggle":"tab","data-bs-target":"#allOrders",type:"button",role:"tab","aria-controls":"nav-home","aria-selected":"true"}," 全部訂單 "),e("button",{class:"nav-link w-10",id:"nav-profile-tab","data-bs-toggle":"tab","data-bs-target":"#unpaid",type:"button",role:"tab","aria-controls":"nav-profile","aria-selected":"false"}," 未付款 "),e("button",{class:"nav-link w-10",id:"nav-contact-tab","data-bs-toggle":"tab","data-bs-target":"#paid",type:"button",role:"tab","aria-controls":"nav-contact","aria-selected":"false"}," 已付款 "),e("button",{class:"nav-link w-10",id:"nav-contact-tab","data-bs-toggle":"tab","data-bs-target":"#delete",type:"button",role:"tab","aria-controls":"nav-contact","aria-selected":"false"}," 已刪除 "),e("button",{class:"nav-link w-10",id:"nav-contact-tab","data-bs-toggle":"tab","data-bs-target":"#done",type:"button",role:"tab","aria-controls":"nav-contact","aria-selected":"false"}," 已完成 ")])],-1),Ee={class:"tab-content m-3",id:"nav-tabContent"},Ve={class:"tab-pane fade show active",id:"allOrders",role:"tabpanel","aria-labelledby":"nav-home-tab",tabindex:"0"},Ue={class:"accordion",id:"accordionPanelsStayOpenExample"},Te={class:"tab-pane fade",id:"unpaid",role:"tabpanel","aria-labelledby":"nav-profile-tab",tabindex:"0"},je={class:"accordion",id:"accordionPanelsStayOpenExample"},Ie={class:"tab-pane fade",id:"paid",role:"tabpanel","aria-labelledby":"nav-contact-tab",tabindex:"0"},Ne={class:"accordion",id:"accordionPanelsStayOpenExample"},$e={class:"tab-pane fade",id:"delete",role:"tabpanel","aria-labelledby":"nav-contact-tab",tabindex:"0"},Le={class:"accordion",id:"accordionPanelsStayOpenExample"},Re={class:"tab-pane fade",id:"done",role:"tabpanel","aria-labelledby":"nav-contact-tab",tabindex:"0"},qe={class:"accordion",id:"accordionPanelsStayOpenExample"},ze={class:"modal fade rounded-2",id:"adOrderModal","data-bs-keyboard":"false",tabindex:"-1","aria-hidden":"true"},Fe={class:"modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable"},Ge={class:"modal-content"},He=e("div",{class:"modal-header bg-primary"},[e("h1",{class:"modal-title h5 fw-medium text-white ps-3 py-2",id:"staticBackdropLabel"}," 訂單詳細資料 "),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Je={class:"modal-body"},Ke={class:""},Qe={class:"p-10 d-flex justify-content-center",style:{"z-index":"10"}},We=J('<div class=""><input type="checkbox" class="btn-check" id="btncheck1" autocomplete="off" checked disabled><label class="btn btn-outline-primary border-2 rounded-circle" for="btncheck1"><i class="bi bi-check-lg fs-2 text-light"></i></label><p class="mt-3 fs-6">收到訂單</p></div>',1),Xe={class:""},Ye=["disabled"],Ze=e("label",{class:"btn btn-outline-primary border-2 rounded-circle",for:"btncheck2"},[e("i",{class:"bi bi-check-lg fs-2 text-light"})],-1),et=e("p",{class:"mt-3 fs-6"},"製作中",-1),tt={class:""},st=["disabled"],ot=e("i",{class:"bi bi-check-lg fs-2 text-light"},null,-1),at=[ot],lt=e("p",{class:"mt-3 fs-6"},"已出貨",-1),dt={class:""},nt=["disabled"],it=e("i",{class:"bi bi-check-lg fs-2 text-light"},null,-1),rt=[it],ct=e("p",{class:"mt-3 fs-6"},"已完成",-1),bt={class:"mb-9"},ut=e("h3",{class:"h4 text-center mb-3 fw-medium"},"客戶資料",-1),_t={class:"border border-light text-start w-75 mx-auto p-2"},mt={class:"fs-6 text-primary m-3"},pt={class:"fs-6 text-primary m-3"},ht={class:"fs-6 text-primary m-3"},ft={class:"fs-6 text-primary m-3"},gt=e("label",{for:"payState",class:"fs-6 text-primary m-3"},"付款狀態：",-1),vt=["disabled"],yt=e("option",{value:!1},"未付款",-1),xt=e("option",{value:!0},"已付款",-1),Ot=[yt,xt],kt=e("h3",{class:"h4 text-center mb-3 fw-medium"},"訂單商品",-1),wt={class:"table align-middle border-primary"},St=e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"text-primary fw-medium"},"商品資訊"),e("th",{scope:"col",class:"text-primary fw-medium"},"數量"),e("th",{scope:"col",class:"text-primary fw-medium"},"價格"),e("th",{scope:"col",class:"text-primary fw-medium"})])],-1),Ct={scope:"row",class:"py-4"},Dt={class:"card border-0 h-10",style:{"max-width":"540px"}},Pt={class:"row g-0 align-items-center"},Mt={class:"col-md-4"},At={class:"ratio ratio-1x1"},Bt=["src"],Et={class:"col-md-8"},Vt={class:"card-body"},Ut={class:"fs-6 card-title text-primary fw-medium"},Tt={class:"text-start fw-normal"},jt={class:"py-4"},It=["onUpdate:modelValue"],Nt={class:"py-4 text-primary"},$t={class:"d-flex justify-content-between mx-4 my-5"},Lt={class:"fs-6"},Rt={key:0,class:"ms-2 fs-6 badge rounded-pill text-bg-deco"},qt={class:"fs-5 me-4 text-primary fw-bold"},zt={class:"modal-footer"},Ft=e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"取消",-1);function Gt(l,s,a,u,t,i){var g,v,y,b,P,M,A,B,E,V,U,T,j,I,N,$,L,R,q;const o=K("Accordion");return r(),c(w,null,[e("div",Me,[Ae,Be,e("div",Ee,[e("div",Ve,[e("button",{type:"button",class:"btn btn-deco",onClick:s[0]||(s[0]=(...n)=>i.deleteAllOrders&&i.deleteAllOrders(...n))},"刪除全部訂單"),e("div",Ue,[x(o,{orders:t.allOrders,openModal:i.openModal,deleteOrder:i.deleteOrder},null,8,["orders","openModal","deleteOrder"])])]),e("div",Te,[e("div",je,[x(o,{orders:t.unpaidOrders,openModal:i.openModal,deleteOrder:i.deleteOrder},null,8,["orders","openModal","deleteOrder"])])]),e("div",Ie,[e("div",Ne,[x(o,{orders:t.paidOrders,openModal:i.openModal,deleteOrder:i.deleteOrder},null,8,["orders","openModal","deleteOrder"])])]),e("div",$e,[e("div",Le,[x(o,{orders:t.deletedOrders,openModal:i.openModal,deleteOrder:i.deleteOrder,confirmDelete:i.confirmDelete},null,8,["orders","openModal","deleteOrder","confirmDelete"])])]),e("div",Re,[e("div",qe,[x(o,{orders:t.doneOrders,openModal:i.openModal,deleteOrder:i.deleteOrder},null,8,["orders","openModal","deleteOrder"])])])])]),e("div",ze,[e("div",Fe,[e("div",Ge,[He,e("div",Je,[e("div",Ke,[e("div",Qe,[We,e("div",{class:h([(g=t.orderStatus)!=null&&g.making?"bg-primary":"bg-light","mt-5"]),style:{height:"10px",width:"20%"}},null,2),e("div",Xe,[O(e("input",{type:"checkbox",class:"btn-check",id:"btncheck2",autocomplete:"off","onUpdate:modelValue":s[1]||(s[1]=n=>t.orderStatus.making=n),disabled:(v=t.orderStatus)==null?void 0:v.sendProduct},null,8,Ye),[[S,t.orderStatus.making]]),Ze,et]),e("div",{class:h(["mt-5",(y=t.orderStatus)!=null&&y.sendProduct?"bg-primary":"bg-light"]),style:{height:"10px",width:"20%"}},null,2),e("div",tt,[O(e("input",{type:"checkbox",class:"btn-check",id:"btncheck3",autocomplete:"off","onUpdate:modelValue":s[2]||(s[2]=n=>t.orderStatus.sendProduct=n),disabled:!((b=t.orderStatus)!=null&&b.making)||((P=t.orderStatus)==null?void 0:P.done)},null,8,st),[[S,t.orderStatus.sendProduct]]),e("label",{class:h(["btn btn-outline-primary border-2 rounded-circle",t.orderStatus.making?"":"btn-outline-light"]),for:"btncheck3"},at,2),lt]),e("div",{class:h(["mt-5",t.orderStatus.done?"bg-primary":"bg-light"]),style:{height:"10px",width:"20%"}},null,2),e("div",dt,[O(e("input",{type:"checkbox",class:"btn-check",id:"btncheck4",autocomplete:"off","onUpdate:modelValue":s[3]||(s[3]=n=>t.orderStatus.done=n),disabled:!t.modalData.is_paid||!t.orderStatus.sendProduct},null,8,nt),[[S,t.orderStatus.done]]),e("label",{class:h(["btn border-2 rounded-circle",[t.modalData.is_paid&&t.orderStatus.sendProduct?"btn-outline-primary":"btn-outline-light"]]),for:"btncheck4"},rt,2),ct])])]),e("div",bt,[ut,e("div",_t,[e("p",mt,"客戶姓名："+d((A=(M=t.modalData)==null?void 0:M.user)==null?void 0:A.name),1),e("p",pt,"客戶地址："+d((E=(B=t.modalData)==null?void 0:B.user)==null?void 0:E.address),1),e("p",ht,"客戶Email："+d((U=(V=t.modalData)==null?void 0:V.user)==null?void 0:U.email),1),e("p",ft,"客戶電話："+d((j=(T=t.modalData)==null?void 0:T.user)==null?void 0:j.tel),1),gt,O(e("select",{class:"form-select d-inline w-25 fs-6",id:"payState","aria-label":"付款狀態","onUpdate:modelValue":s[4]||(s[4]=n=>t.modalData.is_paid=n),disabled:t.orderStatus.done},Ot,8,vt),[[H,t.modalData.is_paid]]),(I=t.modalData)!=null&&I.is_deleted?(r(),c("button",{key:0,type:"button",class:"d-flex mx-1 my-1 btn btn-danger","data-bs-target":"#adOrderModal","data-bs-dismiss":"modal",onClick:s[5]||(s[5]=n=>i.recoverDelete(t.modalData))}," 回復刪除 ")):f("",!0)])]),kt,e("table",wt,[St,e("tbody",null,[(r(!0),c(w,null,C(t.modalProducts,n=>(r(),c("tr",{key:n.id},[e("th",Ct,[e("div",Dt,[e("div",Pt,[e("div",Mt,[e("div",At,[e("img",{src:n.product.imageUrl,class:"img-fluid object-fit-cover",alt:"..."},null,8,Bt)])]),e("div",Et,[e("div",Vt,[e("h5",Ut,d(n.product.title),1),e("small",Tt,d(n.product.category),1)])])])])]),e("td",jt,[O(e("input",{type:"number",class:"p-2 w-25",min:"1","onUpdate:modelValue":F=>n.qty=F,disabled:""},null,8,It),[[Q,n.qty]])]),e("td",Nt,"NT$ "+d(n.total),1)]))),128))])]),e("div",$t,[e("p",Lt,[D(" 優惠券： "),(N=t.modalData)!=null&&N.products?(r(),c("span",Rt,d((R=(L=Object.values(($=t.modalData)==null?void 0:$.products)[0])==null?void 0:L.coupon)==null?void 0:R.code),1)):f("",!0)]),e("p",qt,"總金額："+d(parseInt((q=t.modalData)==null?void 0:q.total)),1)])]),e("div",zt,[Ft,e("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal",onClick:s[6]||(s[6]=n=>i.updateOrder(t.modalData))}," 確認修改 ")])])])])],64)}const Kt=z(Pe,[["render",Gt]]);export{Kt as default};
