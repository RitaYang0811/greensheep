import{S as n}from"./sweetalert2.all-BL4RB5rn.js";import{_ as m,c,b as e,F as h,r as v,d as u,j as _,o as l,w as I,t as d}from"./index-Bivlclvn.js";var L={VITE_APP_API_URL:"https://ec-course-api.hexschool.io/v2",VITE_APP_API_NAME:"greensheep",VITE_LINE_CLIENT_ID:"x9iTcS6m9Fdlz8XFfAbkqs",VITE_LINE_CLIENT_SECRET:"iGiOLRLmU2aNTDuObVQlcP5XzPYSbUzJ9gvUl4YvPzx",BASE_URL:"/greensheep/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_API_URL:P,VITE_APP_API_NAME:x}=L,F={data(){return{isLoading:!1,myFavoritesId:[],myFavoriteProducts:[],deleteId:""}},methods:{checkLogin(){localStorage.getItem("userInfo")?this.getFavorites():n.fire({title:"您尚未登入?",icon:"warning",confirmButtonColor:"#d33",cancelButtonColor:"#566b5a",confirmButtonText:"  是  "}).then(()=>{this.$router.push("/memberLogin")})},getFavorites(){this.isLoading=!0,this.myFavoritesId=[];let s=localStorage.getItem("userInfo");const t=JSON.parse(s).id;this.$http.get("https://greensheep-json-server.onrender.com/favorites").then(o=>{this.isLoading=!1,o.data.forEach(a=>{a.userId===t&&this.myFavoritesId.push(a)}),this.getFavoriteProducts()}).catch(o=>{console.log(o)})},getFavoriteProducts(){this.myFavoriteProducts=[];const s=`${P}/api/${x}/products/all`;this.isLoading=!0,this.$http.get(s).then(t=>{this.isLoading=!1,t.data.products.forEach(r=>{this.myFavoritesId.forEach(o=>{r.id===o.productId&&this.myFavoriteProducts.push(r)})})}).catch(t=>{console.log(t)})},deleteFavoriteProduct(s){this.myFavoritesId.forEach(t=>{t.productId===s&&(this.deleteId=t.id)}),n.fire({title:"是否刪除該最愛?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#566b5a",cancelButtonText:"  否  ",confirmButtonText:"  是  "}).then(t=>{if(t.isConfirmed){this.isLoading=!0;const r=`https://greensheep-json-server.onrender.com/favorites/${this.deleteId}`;this.$http.delete(r).then(()=>{this.isLoading=!1,this.getFavorites(),n.fire({position:"top-end",icon:"success",title:"刪除最愛成功",showConfirmButton:!1,toast:!0,timer:1500})}).catch(o=>{console.log(o)})}})}},mounted(){this.checkLogin()}},y=e("h1",{class:"fs-3 fs-lg-2 text-start mb-6 fw-bold"},"我的收藏",-1),E={class:"d-flex flex-wrap row row-cols-2 row-cols-md-4"},b=["src"],w={class:"card-body text-start d-flex flex-column justify-content-between p-1 flex-grow-1"},T={class:"card-title display-8 text-dark pt-2"},U={class:"mb-2"},C={class:"text-grey66"},B={class:"card-text display-8 text-primary py-2"},V={class:"card-footer"},A=["onClick"];function S(s,t,r,o,a,f){const g=_("RouterLink"),p=_("VueLoading");return l(),c(h,null,[y,e("div",E,[(l(!0),c(h,null,v(a.myFavoriteProducts,i=>(l(),c("div",{class:"col d-flex flex-column product-item mb-6",key:i.id},[u(g,{to:`/products/detail/${i.id}`,class:"position-relative",style:{width:"100%","padding-top":"100%"}},{default:I(()=>[e("img",{src:i.imageUrl,class:"card-img-top position-absolute top-0 start-0 object-fit-cover h-100"},null,8,b)]),_:2},1032,["to"]),e("div",w,[e("h5",T,[e("div",U,d(i.title),1),e("div",C,d(i.category),1)]),e("p",B,"NT$"+d(i.price),1)]),e("div",V,[e("button",{class:"btn btn-primary w-100",type:"button",onClick:k=>f.deleteFavoriteProduct(i.id)}," 移除最愛 ",8,A)])]))),128))]),u(p,{active:a.isLoading},null,8,["active"])],64)}const R=m(F,[["render",S]]);export{R as default};
