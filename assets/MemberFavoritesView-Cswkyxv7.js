import{S as d}from"./sweetalert2.all-DHqf8B6f.js";import{_ as f,c,b as e,F as h,r as p,o as n,d as m,w as g,t as l,j as v}from"./index-B6g3WjpO.js";var I={VITE_APP_API_URL:"https://ec-course-api.hexschool.io/v2",VITE_APP_API_NAME:"greensheep",BASE_URL:"/greensheep/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_API_URL:y,VITE_APP_API_NAME:P}=I,x={data(){return{myFavoritesId:[],myFavoriteProducts:[],deleteId:""}},methods:{checkLogin(){localStorage.getItem("userInfo")?this.getFavorites():d.fire({title:"您尚未登入?",icon:"warning",confirmButtonColor:"#d33",cancelButtonColor:"#566b5a",confirmButtonText:"  是  "}).then(()=>{this.$router.push("/memberLogin")})},getFavorites(){this.myFavoritesId=[];let s=localStorage.getItem("userInfo");const t=JSON.parse(s).id;this.$http.get("https://greensheep-json-server.onrender.com/favorites").then(o=>{o.data.forEach(a=>{a.userId==t&&this.myFavoritesId.push(a)}),this.getFavoriteProducts()}).catch(o=>{console.log(o)})},getFavoriteProducts(){this.myFavoriteProducts=[];const s=`${y}/api/${P}/products/all`;this.$http.get(s).then(t=>{t.data.products.forEach(i=>{this.myFavoritesId.forEach(o=>{i.id==o.productId&&this.myFavoriteProducts.push(i)})})}).catch(t=>{console.log(t)})},deleteFavoriteProduct(s){this.myFavoritesId.forEach(t=>{t.productId==s&&(this.deleteId=t.id)}),d.fire({title:"是否刪除該最愛?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#566b5a",cancelButtonText:"  否  ",confirmButtonText:"  是  "}).then(t=>{if(t.isConfirmed){const i=`https://greensheep-json-server.onrender.com/favorites/${this.deleteId}`;this.$http.delete(i).then(()=>{this.getFavorites()}).catch(o=>{console.log(o)})}})}},mounted(){this.checkLogin()}},F=e("h1",{class:"fs-3 fs-lg-2 text-start mb-6 fw-bold"},"我的收藏",-1),b={class:"d-flex flex-wrap row row-cols-2 row-cols-md-4"},w=["src"],E={class:"card-body text-start d-flex flex-column justify-content-between p-1 flex-grow-1"},B={class:"card-title display-8 text-dark pt-2"},U={class:"mb-2"},$={class:"text-grey66"},A={class:"card-text display-8 text-primary py-2"},k={class:"card-footer"},C=["onClick"];function S(s,t,i,o,a,_){const u=v("router-link");return n(),c(h,null,[F,e("div",b,[(n(!0),c(h,null,p(a.myFavoriteProducts,r=>(n(),c("div",{class:"col d-flex flex-column product-item mb-6",key:r.id},[m(u,{to:`/products/detail/${r.id}`,class:"position-relative",style:{width:"100%","padding-top":"100%"}},{default:g(()=>[e("img",{src:r.imageUrl,class:"card-img-top position-absolute top-0 start-0 object-fit-cover h-100"},null,8,w)]),_:2},1032,["to"]),e("div",E,[e("h5",B,[e("div",U,l(r.title),1),e("div",$,l(r.category),1)]),e("p",A,"NT$"+l(r.price),1)]),e("div",k,[e("button",{class:"btn btn-primary w-100",type:"button",onClick:T=>_.deleteFavoriteProduct(r.id)},"移除最愛",8,C)])]))),128))])],64)}const N=f(x,[["render",S]]);export{N as default};
