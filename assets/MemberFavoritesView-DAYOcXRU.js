import{S as d}from"./sweetalert2.all-CSpjjSTr.js";import{_ as f,c,b as e,F as h,r as p,o as n,d as m,w as g,t as l,j as v}from"./index-x5cJ4SF7.js";var I={VITE_APP_API_URL:"https://ec-course-api.hexschool.io/v2",VITE_APP_API_NAME:"greensheep",VITE_LINE_CLIENT_ID:"x9iTcS6m9Fdlz8XFfAbkqs",VITE_LINE_CLIENT_SECRET:"iGiOLRLmU2aNTDuObVQlcP5XzPYSbUzJ9gvUl4YvPzx",BASE_URL:"/greensheep/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_API_URL:P,VITE_APP_API_NAME:x}=I,F={data(){return{myFavoritesId:[],myFavoriteProducts:[],deleteId:""}},methods:{checkLogin(){localStorage.getItem("userInfo")?this.getFavorites():d.fire({title:"您尚未登入?",icon:"warning",confirmButtonColor:"#d33",cancelButtonColor:"#566b5a",confirmButtonText:"  是  "}).then(()=>{this.$router.push("/memberLogin")})},getFavorites(){this.myFavoritesId=[];let s=localStorage.getItem("userInfo");const t=JSON.parse(s).id;this.$http.get("https://greensheep-json-server.onrender.com/favorites").then(o=>{o.data.forEach(a=>{a.userId==t&&this.myFavoritesId.push(a)}),this.getFavoriteProducts()}).catch(o=>{console.log(o)})},getFavoriteProducts(){this.myFavoriteProducts=[];const s=`${P}/api/${x}/products/all`;this.$http.get(s).then(t=>{t.data.products.forEach(i=>{this.myFavoritesId.forEach(o=>{i.id==o.productId&&this.myFavoriteProducts.push(i)})})}).catch(t=>{console.log(t)})},deleteFavoriteProduct(s){this.myFavoritesId.forEach(t=>{t.productId==s&&(this.deleteId=t.id)}),d.fire({title:"是否刪除該最愛?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#566b5a",cancelButtonText:"  否  ",confirmButtonText:"  是  "}).then(t=>{if(t.isConfirmed){const i=`https://greensheep-json-server.onrender.com/favorites/${this.deleteId}`;this.$http.delete(i).then(()=>{this.getFavorites()}).catch(o=>{console.log(o)})}})}},mounted(){this.checkLogin()}},y=e("h1",{class:"fs-3 fs-lg-2 text-start mb-6 fw-bold"},"我的收藏",-1),E={class:"d-flex flex-wrap row row-cols-2 row-cols-md-4"},b=["src"],w={class:"card-body text-start d-flex flex-column justify-content-between p-1 flex-grow-1"},T={class:"card-title display-8 text-dark pt-2"},U={class:"mb-2"},C={class:"text-grey66"},L={class:"card-text display-8 text-primary py-2"},A={class:"card-footer"},B=["onClick"];function S(s,t,i,o,a,_){const u=v("router-link");return n(),c(h,null,[y,e("div",E,[(n(!0),c(h,null,p(a.myFavoriteProducts,r=>(n(),c("div",{class:"col d-flex flex-column product-item mb-6",key:r.id},[m(u,{to:`/products/detail/${r.id}`,class:"position-relative",style:{width:"100%","padding-top":"100%"}},{default:g(()=>[e("img",{src:r.imageUrl,class:"card-img-top position-absolute top-0 start-0 object-fit-cover h-100"},null,8,b)]),_:2},1032,["to"]),e("div",w,[e("h5",T,[e("div",U,l(r.title),1),e("div",C,l(r.category),1)]),e("p",L,"NT$"+l(r.price),1)]),e("div",A,[e("button",{class:"btn btn-primary w-100",type:"button",onClick:$=>_.deleteFavoriteProduct(r.id)},"移除最愛",8,B)])]))),128))])],64)}const V=f(F,[["render",S]]);export{V as default};
