import{E as w}from"./smtp-6XTZpYJq.js";import{_ as b}from"./GreenSheep-DGMgQRZ1.js";import{_ as v,c,b as e,d as n,w as C,j as f,o as m,x as u,i as _}from"./index-DOG-Oquy.js";const g="https://greensheep-json-server.onrender.com",x={data(){return{securityInput:null,user:{},userId:0,stepState:{first:!0,second:!1,third:!1},securityCode:"",inputCode:"",confirmPassword:""}},methods:{emailRule(s){return/^[\w\.-]+@(gmail\.com|yahoo\.com\.tw)$/.test(s)?!0:"請輸入Gmail/Yahoo帳號"},async sendCode(){if(await this.checkAccounts()){alert("此帳號沒有註冊過喔!");return}this.sendEmail()},async checkAccounts(){try{const s=await this.$http.get(`${g}/users/?email=${this.user.email}`);return s.data.length,console.log(s.data),s.data.length===0}catch(s){console.log(s.response.data)}},sendEmail(){this.securityCode=this.randomCode();const s=`使用者:${this.user.email}<br/>驗證碼:${this.securityCode}<br/>Messages:申請註冊GreenSheep會員<br/> `;w.send({SecureToken:"0435dc8c-9e69-445a-9569-0d031827457c",To:`${this.user.email}`,From:"greensheep0619@gmail.com",Subject:"親愛的會員您好，GreenSheep客服中心寄送驗證碼來囉~",Body:s}).then(t=>{alert("已發送驗證碼到信箱囉!"),this.stepState.first=!1,this.stepState.second=!0})},randomCode(s=5){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let p="";for(let h=0;h<s;h++){const o=Math.floor(Math.random()*t.length);p+=t.charAt(o)}return p},checkCode(){if(this.inputCode===this.securityCode){alert("驗證成功"),this.stepState.second=!1,this.stepState.third=!0;return}alert("驗證碼輸入錯誤")},passwordRule(s){return s!==void 0&&/^(?!.*\d{6,})(?!.*(.)\1{4,}).{6,12}$/.test(s)?!0:"請輸入正確密碼"},confirmPasswordRule(s){return s===this.user.password&&s?!0:"請輸入相同密碼"},onSubmit(){console.log(this.user),this.$http.patch(`${g}/users`,this.user).then(s=>{alert("修改成功囉!"),this.$router.push({name:"MemberLogin"})}).catch(s=>{console.log(s)})}}},k={class:"d-flex flex-column align-items-center py-15"},V=e("div",null,[e("h2",{class:"fs-2"},"WELCOME"),e("p",{class:"text-primary"},"Discover Your Unique Elegance")],-1),S={class:"w-50 member-content"},E={class:"d-flex flex-column align-items-center py-8"},P=e("h1",{class:"fs-1 mb-8"},"會員忘記密碼",-1),j={key:0},M={class:"form-floating mb-3"},R=e("label",{for:"email"},"請輸入Email",-1),U=e("div",{class:"button-img-box me-1"},[e("img",{src:b,alt:"圖像"})],-1),B=e("p",null,"發送驗證碼",-1),G=[U,B],A={key:1},H={class:"form-floating mb-3"},I=e("label",{for:"securityCode"},"請輸入驗證碼",-1),N=e("div",{class:"button-img-box me-1"},[e("img",{src:b,alt:"圖像"})],-1),Y=e("p",null,"送出驗證碼",-1),q=[N,Y],F={key:2},L={class:"form-floating mb-3"},T=e("label",{for:"password"},"請輸入密碼(6-12字元且不連續)",-1),z={class:"form-floating mb-3"},D=e("label",{for:"password"},"請再次確認密碼",-1),O=e("div",{class:"button-img-box me-1"},[e("img",{src:b,alt:"圖像"})],-1),W=e("p",null,"重設密碼",-1),J=[O,W];function K(s,t,p,h,o,l){const a=f("v-field"),i=f("error-message"),y=f("v-form");return m(),c("div",k,[V,e("div",S,[e("div",E,[P,n(y,{ref:"form",class:"member-form"},{default:C(({errors:d})=>[o.stepState.first?(m(),c("div",j,[e("div",M,[n(a,{name:"email",type:"email",class:u(["form-control",{"is-invalid":d.email}]),id:"email","aria-describedby":"emailHelp",placeholder:"請輸入Email (Google/Yahoo)",rules:l.emailRule,modelValue:o.user.email,"onUpdate:modelValue":t[0]||(t[0]=r=>o.user.email=r)},null,8,["class","rules","modelValue"]),R,n(i,{name:"email",class:"invalid-feedback text-start"})]),e("button",{type:"button",class:"d-flex justify-content-center align-items-center btn btn-primary sub-button",onClick:t[1]||(t[1]=(...r)=>l.sendCode&&l.sendCode(...r))},G)])):_("",!0),o.stepState.second?(m(),c("div",A,[e("div",H,[n(a,{id:"securityCode",name:"驗證碼",type:"text",class:u(["form-control",{"is-invalid":d.驗證碼}]),placeholder:"請輸入驗證碼",rules:"required",modelValue:o.inputCode,"onUpdate:modelValue":t[2]||(t[2]=r=>o.inputCode=r)},null,8,["class","modelValue"]),I,n(i,{name:"驗證碼",class:"invalid-feedback text-start"})]),e("button",{type:"button",class:"d-flex justify-content-center align-items-center btn btn-primary sub-button",onClick:t[3]||(t[3]=(...r)=>l.checkCode&&l.checkCode(...r))},q)])):_("",!0),o.stepState.third?(m(),c("div",F,[e("div",L,[n(a,{name:"password",type:"password",class:u(["form-control",{"is-invalid":d.password}]),id:"password","aria-describedby":"passwordHelp",placeholder:"請輸入密碼(6-12字元且不連續)",rules:l.passwordRule,modelValue:o.user.password,"onUpdate:modelValue":t[4]||(t[4]=r=>o.user.password=r)},null,8,["class","rules","modelValue"]),T,n(i,{name:"password",class:"invalid-feedback text-start"})]),e("div",z,[n(a,{name:"confirmPassword",type:"password",class:u(["form-control",{"is-invalid":d.confirmPassword}]),id:"confirmPassword","aria-describedby":"passwordHelp",placeholder:"請再次確認密碼",rules:l.confirmPasswordRule,modelValue:o.confirmPassword,"onUpdate:modelValue":t[5]||(t[5]=r=>o.confirmPassword=r)},null,8,["class","rules","modelValue"]),D,n(i,{name:"confirmPassword",class:"invalid-feedback text-start"})]),e("button",{type:"button",class:"d-flex justify-content-center align-items-center btn btn-primary sub-button",onClick:t[6]||(t[6]=(...r)=>l.onSubmit&&l.onSubmit(...r))},J)])):_("",!0)]),_:1},512)])])])}const $=v(x,[["render",K]]);export{$ as default};
