import{_ as v,c as n,b as s,F as r,r as h,d as w,j as E,o as d,t as l,e as I}from"./index-SYHPK7Jv.js";var L={VITE_APP_API_URL:"https://ec-course-api.hexschool.io/v2",VITE_APP_API_NAME:"greensheep",VITE_LINE_CLIENT_ID:"x9iTcS6m9Fdlz8XFfAbkqs",VITE_LINE_CLIENT_SECRET:"iGiOLRLmU2aNTDuObVQlcP5XzPYSbUzJ9gvUl4YvPzx",BASE_URL:"/greensheep/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_API_URL:O,VITE_APP_API_NAME:P}=L,T={data(){return{isLoading:!1,userEmail:"",userOrders:[]}},methods:{getUser(){let e=localStorage.getItem("userInfo");const i=JSON.parse(e).id;this.$http.get("https://greensheep-json-server.onrender.com/users").then(c=>{c.data.forEach(_=>{_.id===i&&(this.userEmail=_.email)})}).catch(c=>{console.log(c)})},getOrders(){this.isLoading=!0;const e=`${O}/api/${P}/orders`;this.$http.get(e).then(i=>{this.isLoading=!1,i.data.orders.forEach(a=>{a.user.email===this.userEmail&&this.userOrders.push(a)})}).catch(i=>{console.log(i)})},printProducts(e){const i=Object.values(e);let a="";return i.forEach(c=>{a=a+`${c.product.title}, `}),a},printDate(e){let i=0,a=0,c=0;return e=new Date(e*1e3),i=e.getFullYear(),a=e.getMonth(),c=e.getDate(),`${i} / ${a+1} / ${c}`},printStatus(e){return e!=null&&e.done?"訂單已完成":e!=null&&e.sendProduct?"商品已寄出":e!=null&&e.making?"商品製作中":"收到訂單"}},mounted(){this.getUser(),this.getOrders()}},V=s("h1",{class:"fs-3 fs-lg-2 text-start mb-6 fw-bold"},"所有訂單",-1),A={class:"table"},N=s("thead",{class:"bg-primary"},[s("tr",null,[s("th",{scope:"col",class:"py-4 text-white fw-bold"},"訂單編號"),s("th",{scope:"col",class:"py-4 text-white fw-bold"},"下訂日期"),s("th",{scope:"col",class:"py-4 text-white fw-bold"},"商品資訊"),s("th",{scope:"col",class:"py-4 text-white fw-bold"},"訂單狀態"),s("th",{scope:"col",class:"py-4 text-white fw-bold"},"詳細資料")])],-1),S={class:"bg-white"},U={scope:"row",class:"py-4 text-primary fw-medium align-middle"},j={class:"py-4 text-primary align-middle"},D={class:"py-4 text-primary"},$={class:"align-middle"},k={class:"text-primary fw-bold"},M={class:"align-middle"},R=["data-bs-target"],C=s("i",{class:"bi bi-box-arrow-up-right"},null,-1),F=[C],z=["id"],B={class:"modal-dialog modal-lg"},q={class:"modal-content"},X={class:"modal-header bg-primary"},Y={class:"modal-title fs-5 text-light",id:"exampleModalLabel"},J=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),G={class:"modal-body"},Q=["id"],H={class:"accordion-body p-1"},K={class:"ms-3 d-flex align-items-center"},W={class:"fw-medium text-grey66 fs-8 m-2"},Z={class:"fs-6 fw-medium text-dark"},ss={class:"me-7 d-flex text-grey99"},ts={class:"mx-3"},es=s("div",{class:"my-4 border border-1"},null,-1),ls={class:"d-flex justify-content-between mx-4 text-grey66"},os={class:"ms-1"},is={class:"ms-2 fs-8 text-secondary fw-medium"},as={class:"text-primary fw-medium"},cs=s("div",{class:"my-4 border"},null,-1),ns={class:"mb-4"},ds={class:"fs-6 text-primary ms-3 text-start"},_s={class:"mx-2 mb-3"},rs={class:"mx-2 mb-3"},hs={class:"mx-2 mb-3"},ms={class:"mx-2 mb-3"},us={class:"mx-2 mb-3"},ps=s("div",{class:"modal-footer"},[s("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal"},"Close")],-1);function bs(e,i,a,c,_,m){const y=E("VueLoading");return d(),n(r,null,[V,s("table",A,[N,s("tbody",S,[(d(!0),n(r,null,h(_.userOrders,t=>{var u,p,b,f,g,x;return d(),n("tr",{key:t.id},[s("th",U,l(t==null?void 0:t.create_at),1),s("td",j,l(m.printDate(t==null?void 0:t.create_at)),1),s("td",D,[(d(!0),n(r,null,h(Object.values(t.products),o=>(d(),n("div",{class:"mb-1",key:o==null?void 0:o.id},l(o==null?void 0:o.product.title)+" X "+l(o==null?void 0:o.qty),1))),128))]),s("td",$,[s("span",k,l(m.printStatus(t.orderStatus)),1)]),s("td",M,[s("a",{href:"",class:"p-3","data-bs-toggle":"modal","data-bs-target":`#${t.id}`},F,8,R)]),s("div",{class:"modal fade",id:t.id,tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},[s("div",B,[s("div",q,[s("div",X,[s("h1",Y," 訂單編號："+l(t==null?void 0:t.create_at),1),J]),s("div",G,[s("div",{id:t.id,class:"accordion-collapse collapse show",ref_for:!0,ref:"collape"},[s("div",H,[(d(!0),n(r,null,h(Object.values(t.products),o=>(d(),n("div",{class:"d-flex align-items-center justify-content-between my-1",key:o.id},[s("div",K,[s("span",W,l(o.product.category)+" / ",1),s("h3",Z,l(o.product.title),1)]),s("div",ss,[s("span",ts,"數量："+l(o.qty),1),s("p",null,"總價："+l(o.total),1)])]))),128)),es,s("div",ls,[s("p",os,[I(" 優惠券： "),s("span",is,l((p=(u=Object.values(t.products)[0])==null?void 0:u.coupon)==null?void 0:p.code),1)]),s("p",as," 總金額：NT$ "+l((f=(b=Object.values(t.products)[0])==null?void 0:b.coupon)!=null&&f.discount_price?parseInt(t.total)-((x=(g=Object.values(t.products)[0])==null?void 0:g.coupon)==null?void 0:x.discount_price):parseInt(t.total)),1)]),cs,s("div",ns,[s("div",ds,[s("p",_s,"客戶姓名："+l(t.user.name),1),s("p",rs,"客戶電話："+l(t.user.tel),1),s("p",hs,"客戶地址："+l(t.user.address),1),s("p",ms,"客戶Email："+l(t.user.email),1),s("p",us,"備註："+l(t.message),1)])])])],8,Q)]),ps])])],8,z)])}),128))])]),w(y,{active:_.isLoading},null,8,["active"])],64)}const gs=v(T,[["render",bs]]);export{gs as default};
