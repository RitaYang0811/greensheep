import{y as n,C as o}from"./index-PEAonJb-.js";import{S as r}from"./sweetalert2.all-YVr8EH9K.js";const i="https://greensheep-json-server.onrender.com",u=n("likeStore",{state:()=>({isLike:!1}),actions:{async likeInit(s){const e=JSON.parse(localStorage.getItem("userInfo"));if(e===null)return!1;await o.get(`${i}/favorites?userId=${e.id}&&productId=${s}`).then(t=>{t.data.length&&(this.isLike=!0)}).catch(t=>{console.log(t)})},async addToLike(s){const e={productId:`${s}`,userId:`${JSON.parse(localStorage.getItem("userInfo")).id}`},t=await o.get(`${i}/favorites?userId=${e.userId}&&productId=${e.productId}`);t.data.length?o.delete(`${i}/favorites/${t.data[0].id}`).then(()=>{r.fire({position:"top-end",icon:"success",title:"已經移除收藏囉!",showConfirmButton:!1,toast:!0,timer:1500}),this.isLike=!1}):o.post(`${i}/favorites`,e).then(()=>{r.fire({position:"top-end",icon:"success",title:"已加入收藏!",showConfirmButton:!1,toast:!0,timer:1500}),this.isLike=!0}).catch(a=>{console.log(a)})},async isLogin(s){const e=JSON.parse(localStorage.getItem("userInfo"));if(e===null)return r.fire({icon:"warning",title:"請先登入會員喔！",showConfirmButton:!1,timer:1500}),!1;await o.get(`${i}/600/users/${e.id}`,{headers:{Authorization:`Bearer ${e.token}`}}).then(()=>{this.addToLike(s)}).catch(()=>{r.fire({icon:"warning",title:"請先登入會員喔！",showConfirmButton:!1,timer:1500}),this.$router.push({name:"MemberLogin"})})}}});export{u as l};
